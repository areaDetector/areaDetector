<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>areaDetector: /home/runner/work/areaDetector/areaDetector/ffmpegServer/ffmpegServerApp/src/ffmpegServer.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">areaDetector<span id="projectnumber">&#160;3-14</span>
   </div>
   <div id="projectbrief">EPICS areaDetector framework</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_43e0a1f539e00dcfa1a6bc4d4fee4fc2.html">home</a></li><li class="navelem"><a class="el" href="dir_1036706e55c22cab35bc1c58ee689f1d.html">runner</a></li><li class="navelem"><a class="el" href="dir_629f8151d55d307162ff2d619fb1783d.html">work</a></li><li class="navelem"><a class="el" href="dir_eed808bec8b305d58e6db4c904f249c6.html">areaDetector</a></li><li class="navelem"><a class="el" href="dir_64cdf711c4b4aaabab58afd8cbe7e4a1.html">areaDetector</a></li><li class="navelem"><a class="el" href="dir_565e7452dc00749c24100e92d6006961.html">ffmpegServer</a></li><li class="navelem"><a class="el" href="dir_23917ef41a41b3658b6c948a20fee67c.html">ffmpegServerApp</a></li><li class="navelem"><a class="el" href="dir_fb323a3ced923649d3c66c7f4fbbdf22.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">ffmpegServer.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>section License Author: Diamond Light Source, Copyright 2010  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="ffmpeg_server_8h_source.html">ffmpegServer.h</a>&quot;</code><br />
<code>#include &quot;epicsExport.h&quot;</code><br />
<code>#include &quot;iocsh.h&quot;</code><br />
<code>#include &lt;epicsExit.h&gt;</code><br />
<code>#include &lt;epicsThread.h&gt;</code><br />
<code>#include &lt;time.h&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a3acffbd305ee72dcd4593c0d8af64a4f" id="r_a3acffbd305ee72dcd4593c0d8af64a4f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ffmpeg_server_8cpp.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(a,  b)&#160;&#160;&#160;(((a) &lt; (b)) ? (a) : (b))</td></tr>
<tr class="separator:a3acffbd305ee72dcd4593c0d8af64a4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a280ff4f61d0c55000b6d8ae24f2dd09c" id="r_a280ff4f61d0c55000b6d8ae24f2dd09c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ffmpeg_server_8cpp.html#a280ff4f61d0c55000b6d8ae24f2dd09c">dorequest</a> (int sid)</td></tr>
<tr class="memdesc:a280ff4f61d0c55000b6d8ae24f2dd09c"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is called whenever a client requests a stream.  <br /></td></tr>
<tr class="separator:a280ff4f61d0c55000b6d8ae24f2dd09c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b8e117760015cf56c2366b8027670da" id="r_a2b8e117760015cf56c2366b8027670da"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ffmpeg_server_8cpp.html#a2b8e117760015cf56c2366b8027670da">config_read</a> ()</td></tr>
<tr class="memdesc:a2b8e117760015cf56c2366b8027670da"><td class="mdescLeft">&#160;</td><td class="mdescRight">this dummy function is here to satisfy nullhttpd  <br /></td></tr>
<tr class="separator:a2b8e117760015cf56c2366b8027670da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7b0efc9c16f820fb943a67625b2018a" id="r_ae7b0efc9c16f820fb943a67625b2018a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ffmpeg_server_8cpp.html#ae7b0efc9c16f820fb943a67625b2018a">c_shutdown</a> (void *)</td></tr>
<tr class="memdesc:ae7b0efc9c16f820fb943a67625b2018a"><td class="mdescLeft">&#160;</td><td class="mdescRight">c function that will be called at epicsExit that shuts down the http server cleanly  <br /></td></tr>
<tr class="separator:ae7b0efc9c16f820fb943a67625b2018a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a792477deebc3288a3ec478704aa8eb68" id="r_a792477deebc3288a3ec478704aa8eb68"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ffmpeg_server_8cpp.html#a792477deebc3288a3ec478704aa8eb68">ffmpegServerConfigure</a> (int port, const char *networkInterface)</td></tr>
<tr class="memdesc:a792477deebc3288a3ec478704aa8eb68"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configure and start the http server, specifying a specific network interface, or 'any' for default.  <br /></td></tr>
<tr class="separator:a792477deebc3288a3ec478704aa8eb68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5722f6e9a3c9d46f3ea81917b369ab0f" id="r_a5722f6e9a3c9d46f3ea81917b369ab0f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ffmpeg_server_8cpp.html#a5722f6e9a3c9d46f3ea81917b369ab0f">ffmpegStreamConfigure</a> (const char *portName, int queueSize, int blockingCallbacks, const char *NDArrayPort, int NDArrayAddr, int maxBuffers, int maxMemory, int priority, int stackSize)</td></tr>
<tr class="memdesc:a5722f6e9a3c9d46f3ea81917b369ab0f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configuration routine.  <br /></td></tr>
<tr class="separator:a5722f6e9a3c9d46f3ea81917b369ab0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c7eb7c29ce7b6a4161d4dc078179caf" id="r_a0c7eb7c29ce7b6a4161d4dc078179caf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ffmpeg_server_8cpp.html#a0c7eb7c29ce7b6a4161d4dc078179caf">ffmpegServerRegister</a> (void)</td></tr>
<tr class="memdesc:a0c7eb7c29ce7b6a4161d4dc078179caf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Register ffmpegStreamConfigure and ffmpegServerConfigure for use on iocsh.  <br /></td></tr>
<tr class="separator:a0c7eb7c29ce7b6a4161d4dc078179caf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0d78a805fe1e161ee0e0788e6b45cfe" id="r_ac0d78a805fe1e161ee0e0788e6b45cfe"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ffmpeg_server_8cpp.html#ac0d78a805fe1e161ee0e0788e6b45cfe">epicsExportRegistrar</a> (<a class="el" href="ffmpeg_server_8cpp.html#a0c7eb7c29ce7b6a4161d4dc078179caf">ffmpegServerRegister</a>)</td></tr>
<tr class="separator:ac0d78a805fe1e161ee0e0788e6b45cfe"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>section License Author: Diamond Light Source, Copyright 2010 </p>
<p>'ffmpegServer' is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.</p>
<p>'ffmpegServer' is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.</p>
<p>You should have received a copy of the GNU Lesser General Public License along with 'ffmpegServer'. If not, see <a href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>. </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a3acffbd305ee72dcd4593c0d8af64a4f" name="a3acffbd305ee72dcd4593c0d8af64a4f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3acffbd305ee72dcd4593c0d8af64a4f">&#9670;&#160;</a></span>MIN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MIN</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">a, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">b&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;(((a) &lt; (b)) ? (a) : (b))</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ae7b0efc9c16f820fb943a67625b2018a" name="ae7b0efc9c16f820fb943a67625b2018a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7b0efc9c16f820fb943a67625b2018a">&#9670;&#160;</a></span>c_shutdown()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void c_shutdown </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>c function that will be called at epicsExit that shuts down the http server cleanly </p>

</div>
</div>
<a id="a2b8e117760015cf56c2366b8027670da" name="a2b8e117760015cf56c2366b8027670da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b8e117760015cf56c2366b8027670da">&#9670;&#160;</a></span>config_read()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int config_read </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>this dummy function is here to satisfy nullhttpd </p>

</div>
</div>
<a id="a280ff4f61d0c55000b6d8ae24f2dd09c" name="a280ff4f61d0c55000b6d8ae24f2dd09c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a280ff4f61d0c55000b6d8ae24f2dd09c">&#9670;&#160;</a></span>dorequest()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dorequest </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>sid</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This is called whenever a client requests a stream. </p>

</div>
</div>
<a id="ac0d78a805fe1e161ee0e0788e6b45cfe" name="ac0d78a805fe1e161ee0e0788e6b45cfe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0d78a805fe1e161ee0e0788e6b45cfe">&#9670;&#160;</a></span>epicsExportRegistrar()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">epicsExportRegistrar </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ffmpeg_server_8cpp.html#a0c7eb7c29ce7b6a4161d4dc078179caf">ffmpegServerRegister</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a792477deebc3288a3ec478704aa8eb68" name="a792477deebc3288a3ec478704aa8eb68"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a792477deebc3288a3ec478704aa8eb68">&#9670;&#160;</a></span>ffmpegServerConfigure()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ffmpegServerConfigure </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>port</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>networkInterface</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Configure and start the http server, specifying a specific network interface, or 'any' for default. </p>
<p>To specify an interface, use either the DNS name or the IP of the NIC. ex: 10.68.212.33 or my-ioc-server-hostname Default port is 8080. </p>

</div>
</div>
<a id="a0c7eb7c29ce7b6a4161d4dc078179caf" name="a0c7eb7c29ce7b6a4161d4dc078179caf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c7eb7c29ce7b6a4161d4dc078179caf">&#9670;&#160;</a></span>ffmpegServerRegister()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ffmpegServerRegister </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Register ffmpegStreamConfigure and ffmpegServerConfigure for use on iocsh. </p>

</div>
</div>
<a id="a5722f6e9a3c9d46f3ea81917b369ab0f" name="a5722f6e9a3c9d46f3ea81917b369ab0f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5722f6e9a3c9d46f3ea81917b369ab0f">&#9670;&#160;</a></span>ffmpegStreamConfigure()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ffmpegStreamConfigure </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>portName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>queueSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>blockingCallbacks</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>NDArrayPort</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>NDArrayAddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>maxBuffers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>maxMemory</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>priority</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>stackSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Configuration routine. </p>
<p>Called directly, or from the iocsh function, calls <a class="el" href="classffmpeg_stream.html" title="Take an array source and compress it and serve it as an mjpeg stream.">ffmpegStream</a> constructor:</p>
<p>Constructor for <a class="el" href="classffmpeg_stream.html" title="Take an array source and compress it and serve it as an mjpeg stream.">ffmpegStream</a>; Class representing an mjpg stream served up by ffmpegServer.  </p>
<p><a class="el" href="ffmpeg_server_8cpp.html#a792477deebc3288a3ec478704aa8eb68" title="Configure and start the http server, specifying a specific network interface, or &#39;any&#39; for default.">ffmpegServerConfigure()</a> must be called before creating any instances of this class. <a class="el" href="ffmpeg_server_8cpp.html#a5722f6e9a3c9d46f3ea81917b369ab0f" title="Configuration routine.">ffmpegStreamConfigure()</a> should be used to create an instance in the iocsh. See ffmpegStream.template for more details of usage. </p><pre class="fragment">\param portName The name of the asyn port driver to be created.
\param queueSize The number of NDArrays that the input queue for this plugin can hold when 
       NDPluginDriverBlockingCallbacks=0.  Larger queues can decrease the number of dropped arrays,
       at the expense of more NDArray buffers being allocated from the underlying driver's NDArrayPool.
\param blockingCallbacks Initial setting for the NDPluginDriverBlockingCallbacks flag.
       0=callbacks are queued and executed by the callback thread; 1 callbacks execute in the thread
       of the driver doing the callbacks.
\param NDArrayPort Name of asyn port driver for initial source of NDArray callbacks.
\param NDArrayAddr asyn port driver address for initial source of NDArray callbacks.
\param maxBuffers The maximum number of NDArray buffers that the NDArrayPool for this driver is 
       allowed to allocate. Set this to -1 to allow an unlimited number of buffers.
\param maxMemory The maximum amount of memory that the NDArrayPool for this driver is 
       allowed to allocate. Set this to -1 to allow an unlimited amount of memory.
\param priority The thread priority for the asyn port driver thread if ASYN_CANBLOCK is set in asynFlags.
\param stackSize The stack size for the asyn port driver thread if ASYN_CANBLOCK is set in asynFlags.
</pre>   
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
