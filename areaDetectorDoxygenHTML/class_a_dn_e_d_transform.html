<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>areaDetector: ADnEDTransform Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">areaDetector<span id="projectnumber">&#160;3-14</span>
   </div>
   <div id="projectbrief">EPICS areaDetector framework</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="class_a_dn_e_d_transform-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">ADnEDTransform Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Library of functions to use for transforming the time of flight value into another parameter (for example dspace).  
 <a href="class_a_dn_e_d_transform.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="_a_dn_e_d_transform_8h_source.html">ADnEDTransform.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for ADnEDTransform:</div>
<div class="dyncontent">
 <div class="center">
  <img src="class_a_dn_e_d_transform.png" usemap="#ADnEDTransform_map" alt=""/>
  <map id="ADnEDTransform_map" name="ADnEDTransform_map">
<area href="class_a_dn_e_d_transform_base.html" title="ADnEDTransform base class." alt="ADnEDTransformBase" shape="rect" coords="0,0,139,24"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a983598b51eb7c1e38cd36c7efe8764d4" id="r_a983598b51eb7c1e38cd36c7efe8764d4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_a_dn_e_d_transform.html#a983598b51eb7c1e38cd36c7efe8764d4">ADnEDTransform</a> ()</td></tr>
<tr class="memdesc:a983598b51eb7c1e38cd36c7efe8764d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <br /></td></tr>
<tr class="separator:a983598b51eb7c1e38cd36c7efe8764d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e49fe6ae5ed8f40b56c26c232568b20" id="r_a6e49fe6ae5ed8f40b56c26c232568b20"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_a_dn_e_d_transform.html#a6e49fe6ae5ed8f40b56c26c232568b20">~ADnEDTransform</a> ()</td></tr>
<tr class="memdesc:a6e49fe6ae5ed8f40b56c26c232568b20"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor.  <br /></td></tr>
<tr class="separator:a6e49fe6ae5ed8f40b56c26c232568b20"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ed7692302b2338aa1117b45ddfcb8e4" id="r_a7ed7692302b2338aa1117b45ddfcb8e4"><td class="memItemLeft" align="right" valign="top">epicsFloat64&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_a_dn_e_d_transform.html#a7ed7692302b2338aa1117b45ddfcb8e4">calculate</a> (epicsUInt32 type, epicsUInt32 pixelID, epicsUInt32 tof) const</td></tr>
<tr class="memdesc:a7ed7692302b2338aa1117b45ddfcb8e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transform the time of flight value into a another parameter.  <br /></td></tr>
<tr class="separator:a7ed7692302b2338aa1117b45ddfcb8e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_class_a_dn_e_d_transform_base"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_class_a_dn_e_d_transform_base')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="class_a_dn_e_d_transform_base.html">ADnEDTransformBase</a></td></tr>
<tr class="memitem:a42d7b421620c51fc77ee626855b6c3bc inherit pub_methods_class_a_dn_e_d_transform_base" id="r_a42d7b421620c51fc77ee626855b6c3bc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_a_dn_e_d_transform_base.html#a42d7b421620c51fc77ee626855b6c3bc">ADnEDTransformBase</a> ()</td></tr>
<tr class="memdesc:a42d7b421620c51fc77ee626855b6c3bc inherit pub_methods_class_a_dn_e_d_transform_base"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="class_a_dn_e_d_transform.html" title="Library of functions to use for transforming the time of flight value into another parameter (for exa...">ADnEDTransform</a> base class.  <br /></td></tr>
<tr class="separator:a42d7b421620c51fc77ee626855b6c3bc inherit pub_methods_class_a_dn_e_d_transform_base"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af29288635236c8cdf1aad56d14ab40e1 inherit pub_methods_class_a_dn_e_d_transform_base" id="r_af29288635236c8cdf1aad56d14ab40e1"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_a_dn_e_d_transform_base.html#af29288635236c8cdf1aad56d14ab40e1">~ADnEDTransformBase</a> ()</td></tr>
<tr class="memdesc:af29288635236c8cdf1aad56d14ab40e1 inherit pub_methods_class_a_dn_e_d_transform_base"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor.  <br /></td></tr>
<tr class="separator:af29288635236c8cdf1aad56d14ab40e1 inherit pub_methods_class_a_dn_e_d_transform_base"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20f2b5688e3295651318777f9365cb97 inherit pub_methods_class_a_dn_e_d_transform_base" id="r_a20f2b5688e3295651318777f9365cb97"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_a_dn_e_d_transform_base.html#a20f2b5688e3295651318777f9365cb97">setIntParam</a> (epicsUInt32 paramIndex, epicsUInt32 paramVal)</td></tr>
<tr class="memdesc:a20f2b5688e3295651318777f9365cb97 inherit pub_methods_class_a_dn_e_d_transform_base"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set integer param.  <br /></td></tr>
<tr class="separator:a20f2b5688e3295651318777f9365cb97 inherit pub_methods_class_a_dn_e_d_transform_base"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b0dfe3ead5eeac1b2ab63732997fbe3 inherit pub_methods_class_a_dn_e_d_transform_base" id="r_a9b0dfe3ead5eeac1b2ab63732997fbe3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_a_dn_e_d_transform_base.html#a9b0dfe3ead5eeac1b2ab63732997fbe3">setDoubleParam</a> (epicsUInt32 paramIndex, epicsFloat64 paramVal)</td></tr>
<tr class="memdesc:a9b0dfe3ead5eeac1b2ab63732997fbe3 inherit pub_methods_class_a_dn_e_d_transform_base"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set double param.  <br /></td></tr>
<tr class="separator:a9b0dfe3ead5eeac1b2ab63732997fbe3 inherit pub_methods_class_a_dn_e_d_transform_base"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abcfffba535cbea764554fba6ba80d40b inherit pub_methods_class_a_dn_e_d_transform_base" id="r_abcfffba535cbea764554fba6ba80d40b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_a_dn_e_d_transform_base.html#abcfffba535cbea764554fba6ba80d40b">setDoubleArray</a> (epicsUInt32 paramIndex, const epicsFloat64 *pSource, epicsUInt32 size)</td></tr>
<tr class="memdesc:abcfffba535cbea764554fba6ba80d40b inherit pub_methods_class_a_dn_e_d_transform_base"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set array of doubles.  <br /></td></tr>
<tr class="separator:abcfffba535cbea764554fba6ba80d40b inherit pub_methods_class_a_dn_e_d_transform_base"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95b80f6a697d9b5d639085c3734105f1 inherit pub_methods_class_a_dn_e_d_transform_base" id="r_a95b80f6a697d9b5d639085c3734105f1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_a_dn_e_d_transform_base.html#a95b80f6a697d9b5d639085c3734105f1">printParams</a> (void) const</td></tr>
<tr class="memdesc:a95b80f6a697d9b5d639085c3734105f1 inherit pub_methods_class_a_dn_e_d_transform_base"><td class="mdescLeft">&#160;</td><td class="mdescRight">For debug, print all to stdout.  <br /></td></tr>
<tr class="separator:a95b80f6a697d9b5d639085c3734105f1 inherit pub_methods_class_a_dn_e_d_transform_base"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7992fbee77d6bc255fa945985b8f0f5 inherit pub_methods_class_a_dn_e_d_transform_base" id="r_ac7992fbee77d6bc255fa945985b8f0f5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_a_dn_e_d_transform_base.html#ac7992fbee77d6bc255fa945985b8f0f5">setDebug</a> (bool debug)</td></tr>
<tr class="separator:ac7992fbee77d6bc255fa945985b8f0f5 inherit pub_methods_class_a_dn_e_d_transform_base"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="inherited" name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pro_attribs_class_a_dn_e_d_transform_base"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_class_a_dn_e_d_transform_base')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="class_a_dn_e_d_transform_base.html">ADnEDTransformBase</a></td></tr>
<tr class="memitem:a6c271e9a5155a507d2e2cf0e21b63c58 inherit pro_attribs_class_a_dn_e_d_transform_base" id="r_a6c271e9a5155a507d2e2cf0e21b63c58"><td class="memItemLeft" align="right" valign="top">epicsUInt32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_a_dn_e_d_transform_base.html#a6c271e9a5155a507d2e2cf0e21b63c58">m_intParam</a> [<a class="el" href="_a_dn_e_d_globals_8h.html#a63e3f4ebebdd7c6b1b22edec5f29adb5">ADNED_MAX_TRANSFORM_PARAMS</a>]</td></tr>
<tr class="separator:a6c271e9a5155a507d2e2cf0e21b63c58 inherit pro_attribs_class_a_dn_e_d_transform_base"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0dfca61aca333413228d4331104054c5 inherit pro_attribs_class_a_dn_e_d_transform_base" id="r_a0dfca61aca333413228d4331104054c5"><td class="memItemLeft" align="right" valign="top">epicsFloat64&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_a_dn_e_d_transform_base.html#a0dfca61aca333413228d4331104054c5">m_doubleParam</a> [<a class="el" href="_a_dn_e_d_globals_8h.html#a63e3f4ebebdd7c6b1b22edec5f29adb5">ADNED_MAX_TRANSFORM_PARAMS</a>]</td></tr>
<tr class="separator:a0dfca61aca333413228d4331104054c5 inherit pro_attribs_class_a_dn_e_d_transform_base"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4751e7ce1ea5f1350c5dacf89d8d9237 inherit pro_attribs_class_a_dn_e_d_transform_base" id="r_a4751e7ce1ea5f1350c5dacf89d8d9237"><td class="memItemLeft" align="right" valign="top">epicsFloat64 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_a_dn_e_d_transform_base.html#a4751e7ce1ea5f1350c5dacf89d8d9237">p_Array</a> [<a class="el" href="_a_dn_e_d_globals_8h.html#a63e3f4ebebdd7c6b1b22edec5f29adb5">ADNED_MAX_TRANSFORM_PARAMS</a>]</td></tr>
<tr class="separator:a4751e7ce1ea5f1350c5dacf89d8d9237 inherit pro_attribs_class_a_dn_e_d_transform_base"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9cdc8521f43b0006016b0f94e480c9b7 inherit pro_attribs_class_a_dn_e_d_transform_base" id="r_a9cdc8521f43b0006016b0f94e480c9b7"><td class="memItemLeft" align="right" valign="top">epicsUInt32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_a_dn_e_d_transform_base.html#a9cdc8521f43b0006016b0f94e480c9b7">m_ArraySize</a> [<a class="el" href="_a_dn_e_d_globals_8h.html#a63e3f4ebebdd7c6b1b22edec5f29adb5">ADNED_MAX_TRANSFORM_PARAMS</a>]</td></tr>
<tr class="separator:a9cdc8521f43b0006016b0f94e480c9b7 inherit pro_attribs_class_a_dn_e_d_transform_base"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a357bdb4c70f0318e2c1d2d9128d4452a inherit pro_attribs_class_a_dn_e_d_transform_base" id="r_a357bdb4c70f0318e2c1d2d9128d4452a"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_a_dn_e_d_transform_base.html#a357bdb4c70f0318e2c1d2d9128d4452a">m_debug</a></td></tr>
<tr class="separator:a357bdb4c70f0318e2c1d2d9128d4452a inherit pro_attribs_class_a_dn_e_d_transform_base"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Library of functions to use for transforming the time of flight value into another parameter (for example dspace). </p>
<p>The code is compiled into a seperate library and linked in with the <a class="el" href="class_a_dn_e_d.html">ADnED</a> IOC application. This makes it easy to modify or swap out with a different library. The library must be thread safe, and only one instance should be created per detector instance. It does depend on the <a class="el" href="_a_dn_e_d_globals_8h.html">ADnEDGlobals.h</a> file.</p>
<p>Objects of this class have a range of parameters and arrays for use in the calculations. They are set by <a class="el" href="class_a_dn_e_d.html">ADnED</a>. Array storage is managed internally. The size of the arrays must be equal to the pixel ID range size for a particular detector.</p>
<p>The internal parameters that can be set, which are used in the calculations are: N * epicsUInt32 parameters N * epicsFloat64 parameters N * arrays of type epicsFloat64</p>
<p>The documentation for each calculation type will specify which parameter is used.</p>
<dl class="section author"><dt>Author</dt><dd>Matt Pearson </dd></dl>
<dl class="section date"><dt>Date</dt><dd>April 2015 </dd></dl>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a983598b51eb7c1e38cd36c7efe8764d4" name="a983598b51eb7c1e38cd36c7efe8764d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a983598b51eb7c1e38cd36c7efe8764d4">&#9670;&#160;</a></span>ADnEDTransform()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ADnEDTransform::ADnEDTransform </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor. </p>
<p><br  />
 </p>

</div>
</div>
<a id="a6e49fe6ae5ed8f40b56c26c232568b20" name="a6e49fe6ae5ed8f40b56c26c232568b20"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e49fe6ae5ed8f40b56c26c232568b20">&#9670;&#160;</a></span>~ADnEDTransform()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">ADnEDTransform::~ADnEDTransform </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Destructor. </p>
<p><br  />
 </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a7ed7692302b2338aa1117b45ddfcb8e4" name="a7ed7692302b2338aa1117b45ddfcb8e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ed7692302b2338aa1117b45ddfcb8e4">&#9670;&#160;</a></span>calculate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">epicsFloat64 ADnEDTransform::calculate </td>
          <td>(</td>
          <td class="paramtype">epicsUInt32&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">epicsUInt32&#160;</td>
          <td class="paramname"><em>pixelID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">epicsUInt32&#160;</td>
          <td class="paramname"><em>tof</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Transform the time of flight value into a another parameter. </p>
<p>The calculation used is specified by the type input param. The associated pixel ID is required for any calculation involving a pixelID based lookup in an array.</p>
<p>Note: this could be a static factory method, returning <a class="el" href="class_a_dn_e_d_transform_base.html" title="ADnEDTransform base class.">ADnEDTransformBase</a> objects</p>
<p>Transform types are:</p>
<p>ADNED_TRANSFORM_TYPE1 - multiply the TOF by a pixel ID lookup in doubleArray[0]. Can be used for fixed geometry instruments to calculate dspace. Can be used on Vulcan for example.</p>
<p>ADNED_TRANSFORM_TYPE2 - calculate dspace where the theta angle changes. Used for direct geometry instruments like Hyspec. NOTE: not sure how this works yet. <br  />
</p>
<p>ADNED_TRANSFORM_TYPE3 - calculate deltaE for indirect geometry instruments for their inelastic detectors. This uses an equation which depends on the mass of the neutron, L1, an array of L2 and an array of Ef. The final energy per-pixelID, Ef, is known because of the use of mirrors to select energy. We can calculate incident energy using the known final energy and the TOF. So we are calculating energy transfer for each event.</p>
<p>deltaE = (1/2)Mn * (L1 / (TOF - (L2*sqrt(Mn/(2*Ef))) ) )**2 - Ef where: Mn = mass of neutron in 1.674954 × 10-27 L1 = constant (in meters) Ef and L2 are double arrays based on pixelID. The Ef input array must be in units of MeV. The L2 array is in meters. TOF = time of flight (in seconds)</p>
<p>Energy must be in Joules (1 eV = 1.602176565(35) × 10−19 J)</p>
<p>Once the deltaE has been obtained in Joules, it is converted back to MeV. </p>

<p>Implements <a class="el" href="class_a_dn_e_d_transform_base.html#a5408c9bb026b902610d14b97fb700d17">ADnEDTransformBase</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/runner/work/areaDetector/areaDetector/ADnED/ADnEDApp/src/<a class="el" href="_a_dn_e_d_transform_8h_source.html">ADnEDTransform.h</a></li>
<li>/home/runner/work/areaDetector/areaDetector/ADnED/ADnEDApp/src/<a class="el" href="_a_dn_e_d_transform_8cpp.html">ADnEDTransform.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
