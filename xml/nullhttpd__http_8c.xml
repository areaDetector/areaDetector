<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.9.1" xml:lang="en-US">
  <compounddef id="nullhttpd__http_8c" kind="file" language="C++">
    <compoundname>nullhttpd_http.c</compoundname>
    <includes refid="nullhttpd_8h" local="yes">nullhttpd.h</includes>
    <incdepgraph>
      <node id="10">
        <label>sys/stat.h</label>
      </node>
      <node id="5">
        <label>stdarg.h</label>
      </node>
      <node id="18">
        <label>netinet/in.h</label>
      </node>
      <node id="17">
        <label>arpa/inet.h</label>
      </node>
      <node id="7">
        <label>stdlib.h</label>
      </node>
      <node id="13">
        <label>paths.h</label>
      </node>
      <node id="4">
        <label>fcntl.h</label>
      </node>
      <node id="12">
        <label>netdb.h</label>
      </node>
      <node id="19">
        <label>sys/resource.h</label>
      </node>
      <node id="14">
        <label>pthread.h</label>
      </node>
      <node id="22">
        <label>sys/types.h</label>
      </node>
      <node id="8">
        <label>string.h</label>
      </node>
      <node id="16">
        <label>unistd.h</label>
      </node>
      <node id="15">
        <label>signal.h</label>
      </node>
      <node id="9">
        <label>time.h</label>
      </node>
      <node id="23">
        <label>sys/wait.h</label>
      </node>
      <node id="2">
        <label>nullhttpd.h</label>
        <link refid="nullhttpd_8h"/>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="8" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
        <childnode refid="14" relation="include">
        </childnode>
        <childnode refid="15" relation="include">
        </childnode>
        <childnode refid="16" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
        <childnode refid="18" relation="include">
        </childnode>
        <childnode refid="19" relation="include">
        </childnode>
        <childnode refid="20" relation="include">
        </childnode>
        <childnode refid="21" relation="include">
        </childnode>
        <childnode refid="22" relation="include">
        </childnode>
        <childnode refid="23" relation="include">
        </childnode>
      </node>
      <node id="21">
        <label>sys/time.h</label>
      </node>
      <node id="3">
        <label>ctype.h</label>
      </node>
      <node id="20">
        <label>sys/socket.h</label>
      </node>
      <node id="1">
        <label>/home/runner/work/areaDetector/areaDetector/ffmpegServer/ffmpegServerApp/src/nullhttpd_http.c</label>
        <link refid="nullhttpd__http_8c"/>
        <childnode refid="2" relation="include">
        </childnode>
      </node>
      <node id="6">
        <label>stdio.h</label>
      </node>
      <node id="11">
        <label>dirent.h</label>
      </node>
    </incdepgraph>
      <sectiondef kind="define">
      <memberdef kind="define" id="nullhttpd__http_8c_1ad435f7aea25c4470de2a2250d5b85369" prot="public" static="no">
        <name>RFC1123FMT</name>
        <initializer>&quot;%a, %d %b %Y %H:%M:%S GMT&quot;</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/runner/work/areaDetector/areaDetector/ffmpegServer/ffmpegServerApp/src/nullhttpd_http.c" line="21" column="9" bodyfile="/home/runner/work/areaDetector/areaDetector/ffmpegServer/ffmpegServerApp/src/nullhttpd_http.c" bodystart="21" bodyend="-1"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="func">
      <memberdef kind="function" id="nullhttpd__http_8c_1ad4a81cea18f472f3df2e85494113dcc5" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void printerror</definition>
        <argsstring>(int sid, int status, char *title, char *text)</argsstring>
        <name>printerror</name>
        <param>
          <type>int</type>
          <declname>sid</declname>
        </param>
        <param>
          <type>int</type>
          <declname>status</declname>
        </param>
        <param>
          <type>char *</type>
          <declname>title</declname>
        </param>
        <param>
          <type>char *</type>
          <declname>text</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/runner/work/areaDetector/areaDetector/ffmpegServer/ffmpegServerApp/src/nullhttpd_http.c" line="23" column="6" bodyfile="/home/runner/work/areaDetector/areaDetector/ffmpegServer/ffmpegServerApp/src/nullhttpd_http.c" bodystart="23" bodyend="35"/>
      </memberdef>
      <memberdef kind="function" id="nullhttpd__http_8c_1ad8d0362486b46e83729c01a679de74ca" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>char *</type>
        <definition>char* get_mime_type</definition>
        <argsstring>(char *name)</argsstring>
        <name>get_mime_type</name>
        <param>
          <type>char *</type>
          <declname>name</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/runner/work/areaDetector/areaDetector/ffmpegServer/ffmpegServerApp/src/nullhttpd_http.c" line="37" column="6" bodyfile="/home/runner/work/areaDetector/areaDetector/ffmpegServer/ffmpegServerApp/src/nullhttpd_http.c" bodystart="37" bodyend="89"/>
      </memberdef>
      <memberdef kind="function" id="nullhttpd__http_8c_1adb5da8c9918f106775943cf27a171a3b" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ReadPOSTData</definition>
        <argsstring>(int sid)</argsstring>
        <name>ReadPOSTData</name>
        <param>
          <type>int</type>
          <declname>sid</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/runner/work/areaDetector/areaDetector/ffmpegServer/ffmpegServerApp/src/nullhttpd_http.c" line="91" column="6" bodyfile="/home/runner/work/areaDetector/areaDetector/ffmpegServer/ffmpegServerApp/src/nullhttpd_http.c" bodystart="91" bodyend="117"/>
      </memberdef>
      <memberdef kind="function" id="nullhttpd__http_8c_1a1a9bc17fc2e0a0bf0fd9be63bf1faffc" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int read_header</definition>
        <argsstring>(int sid)</argsstring>
        <name>read_header</name>
        <param>
          <type>int</type>
          <declname>sid</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/runner/work/areaDetector/areaDetector/ffmpegServer/ffmpegServerApp/src/nullhttpd_http.c" line="119" column="5" bodyfile="/home/runner/work/areaDetector/areaDetector/ffmpegServer/ffmpegServerApp/src/nullhttpd_http.c" bodystart="119" bodyend="198"/>
      </memberdef>
      <memberdef kind="function" id="nullhttpd__http_8c_1aed2a33b5bb684d7b757196a9c32a9fee" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void send_header</definition>
        <argsstring>(int sid, int cacheable, int status, char *title, char *extra_header, char *mime_type, int length, time_t mod)</argsstring>
        <name>send_header</name>
        <param>
          <type>int</type>
          <declname>sid</declname>
        </param>
        <param>
          <type>int</type>
          <declname>cacheable</declname>
        </param>
        <param>
          <type>int</type>
          <declname>status</declname>
        </param>
        <param>
          <type>char *</type>
          <declname>title</declname>
        </param>
        <param>
          <type>char *</type>
          <declname>extra_header</declname>
        </param>
        <param>
          <type>char *</type>
          <declname>mime_type</declname>
        </param>
        <param>
          <type>int</type>
          <declname>length</declname>
        </param>
        <param>
          <type>time_t</type>
          <declname>mod</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/runner/work/areaDetector/areaDetector/ffmpegServer/ffmpegServerApp/src/nullhttpd_http.c" line="200" column="6" bodyfile="/home/runner/work/areaDetector/areaDetector/ffmpegServer/ffmpegServerApp/src/nullhttpd_http.c" bodystart="200" bodyend="233"/>
      </memberdef>
      <memberdef kind="function" id="nullhttpd__http_8c_1a02debcd1a761c6a92250717ab540b0c0" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void send_fileheader</definition>
        <argsstring>(int sid, int cacheable, int status, char *title, char *extra_header, char *mime_type, int length, time_t mod)</argsstring>
        <name>send_fileheader</name>
        <param>
          <type>int</type>
          <declname>sid</declname>
        </param>
        <param>
          <type>int</type>
          <declname>cacheable</declname>
        </param>
        <param>
          <type>int</type>
          <declname>status</declname>
        </param>
        <param>
          <type>char *</type>
          <declname>title</declname>
        </param>
        <param>
          <type>char *</type>
          <declname>extra_header</declname>
        </param>
        <param>
          <type>char *</type>
          <declname>mime_type</declname>
        </param>
        <param>
          <type>int</type>
          <declname>length</declname>
        </param>
        <param>
          <type>time_t</type>
          <declname>mod</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/runner/work/areaDetector/areaDetector/ffmpegServer/ffmpegServerApp/src/nullhttpd_http.c" line="235" column="6" bodyfile="/home/runner/work/areaDetector/areaDetector/ffmpegServer/ffmpegServerApp/src/nullhttpd_http.c" bodystart="235" bodyend="292"/>
      </memberdef>
      </sectiondef>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">/*</highlight></codeline>
<codeline lineno="2"><highlight class="comment"><sp/><sp/><sp/><sp/>Null<sp/>httpd<sp/>--<sp/>simple<sp/>http<sp/>server</highlight></codeline>
<codeline lineno="3"><highlight class="comment"><sp/><sp/><sp/><sp/>Copyright<sp/>(C)<sp/>2001-2002<sp/>Dan<sp/>Cahill</highlight></codeline>
<codeline lineno="4"><highlight class="comment"></highlight></codeline>
<codeline lineno="5"><highlight class="comment"><sp/><sp/><sp/><sp/>This<sp/>program<sp/>is<sp/>free<sp/>software;<sp/>you<sp/>can<sp/>redistribute<sp/>it<sp/>and/or<sp/>modify</highlight></codeline>
<codeline lineno="6"><highlight class="comment"><sp/><sp/><sp/><sp/>it<sp/>under<sp/>the<sp/>terms<sp/>of<sp/>the<sp/>GNU<sp/>General<sp/>Public<sp/>License<sp/>as<sp/>published<sp/>by</highlight></codeline>
<codeline lineno="7"><highlight class="comment"><sp/><sp/><sp/><sp/>the<sp/>Free<sp/>Software<sp/>Foundation;<sp/>either<sp/>version<sp/>2<sp/>of<sp/>the<sp/>License,<sp/>or</highlight></codeline>
<codeline lineno="8"><highlight class="comment"><sp/><sp/><sp/><sp/>(at<sp/>your<sp/>option)<sp/>any<sp/>later<sp/>version.</highlight></codeline>
<codeline lineno="9"><highlight class="comment"></highlight></codeline>
<codeline lineno="10"><highlight class="comment"><sp/><sp/><sp/><sp/>This<sp/>program<sp/>is<sp/>distributed<sp/>in<sp/>the<sp/>hope<sp/>that<sp/>it<sp/>will<sp/>be<sp/>useful,</highlight></codeline>
<codeline lineno="11"><highlight class="comment"><sp/><sp/><sp/><sp/>but<sp/>WITHOUT<sp/>ANY<sp/>WARRANTY;<sp/>without<sp/>even<sp/>the<sp/>implied<sp/>warranty<sp/>of</highlight></codeline>
<codeline lineno="12"><highlight class="comment"><sp/><sp/><sp/><sp/>MERCHANTABILITY<sp/>or<sp/>FITNESS<sp/>FOR<sp/>A<sp/>PARTICULAR<sp/>PURPOSE.<sp/><sp/>See<sp/>the</highlight></codeline>
<codeline lineno="13"><highlight class="comment"><sp/><sp/><sp/><sp/>GNU<sp/>General<sp/>Public<sp/>License<sp/>for<sp/>more<sp/>details.</highlight></codeline>
<codeline lineno="14"><highlight class="comment"></highlight></codeline>
<codeline lineno="15"><highlight class="comment"><sp/><sp/><sp/><sp/>You<sp/>should<sp/>have<sp/>received<sp/>a<sp/>copy<sp/>of<sp/>the<sp/>GNU<sp/>General<sp/>Public<sp/>License</highlight></codeline>
<codeline lineno="16"><highlight class="comment"><sp/><sp/><sp/><sp/>along<sp/>with<sp/>this<sp/>program;<sp/>if<sp/>not,<sp/>write<sp/>to<sp/>the<sp/>Free<sp/>Software</highlight></codeline>
<codeline lineno="17"><highlight class="comment"><sp/><sp/><sp/><sp/>Foundation,<sp/>Inc.,<sp/>59<sp/>Temple<sp/>Place,<sp/>Suite<sp/>330,<sp/>Boston,<sp/>MA<sp/><sp/>02111-1307<sp/><sp/>USA</highlight></codeline>
<codeline lineno="18"><highlight class="comment">*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="19"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="nullhttpd_8h" kindref="compound">nullhttpd.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="20"><highlight class="normal"></highlight></codeline>
<codeline lineno="21"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>RFC1123FMT<sp/>&quot;%a,<sp/>%d<sp/>%b<sp/>%Y<sp/>%H:%M:%S<sp/>GMT&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="22"><highlight class="normal"></highlight></codeline>
<codeline lineno="23"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="nullhttpd__http_8c_1ad4a81cea18f472f3df2e85494113dcc5" kindref="member">printerror</ref>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>sid,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>status,<sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/>title,<sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/><ref refid="namespacemake_adl_1aeae8cdfc3da757448dc449a5ec6a2ce9" kindref="member">text</ref>)</highlight></codeline>
<codeline lineno="24"><highlight class="normal">{</highlight></codeline>
<codeline lineno="25"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="nullhttpd__http_8c_1aed2a33b5bb684d7b757196a9c32a9fee" kindref="member">send_header</ref>(sid,<sp/>0,<sp/>200,<sp/></highlight><highlight class="stringliteral">&quot;OK&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;1&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;text/html&quot;</highlight><highlight class="normal">,<sp/>-1,<sp/>-1);</highlight></codeline>
<codeline lineno="26"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="nullhttpd_8h_1a5d3bd1a7f401fdd0efae6fdb4280e0fb" kindref="member">prints</ref>(</highlight><highlight class="stringliteral">&quot;&lt;HTML&gt;&lt;HEAD&gt;&lt;TITLE&gt;%d<sp/>%s&lt;/TITLE&gt;&lt;/HEAD&gt;\n&quot;</highlight><highlight class="normal">,<sp/>status,<sp/>title);</highlight></codeline>
<codeline lineno="27"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="nullhttpd_8h_1a5d3bd1a7f401fdd0efae6fdb4280e0fb" kindref="member">prints</ref>(</highlight><highlight class="stringliteral">&quot;&lt;BODY<sp/>BGCOLOR=#F0F0F0<sp/>TEXT=#000000<sp/>LINK=#0000FF<sp/>ALINK=#0000FF<sp/>VLINK=#0000FF&gt;\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="28"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="nullhttpd_8h_1a5d3bd1a7f401fdd0efae6fdb4280e0fb" kindref="member">prints</ref>(</highlight><highlight class="stringliteral">&quot;&lt;H1&gt;%d<sp/>%s&lt;/H1&gt;\n&quot;</highlight><highlight class="normal">,<sp/>status,<sp/>title);</highlight></codeline>
<codeline lineno="29"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="nullhttpd_8h_1a5d3bd1a7f401fdd0efae6fdb4280e0fb" kindref="member">prints</ref>(</highlight><highlight class="stringliteral">&quot;%s\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="namespacemake_adl_1aeae8cdfc3da757448dc449a5ec6a2ce9" kindref="member">text</ref>);</highlight></codeline>
<codeline lineno="30"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="nullhttpd_8h_1a5d3bd1a7f401fdd0efae6fdb4280e0fb" kindref="member">prints</ref>(</highlight><highlight class="stringliteral">&quot;&lt;HR&gt;\n&lt;ADDRESS&gt;%s&lt;/ADDRESS&gt;\n&lt;/BODY&gt;&lt;/HTML&gt;\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="nullhttpd_8h_1af00aa3c79fe31d435739c34e4c989835" kindref="member">SERVER_NAME</ref>);</highlight></codeline>
<codeline lineno="31"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].<ref refid="struct_c_o_n_n_e_c_t_i_o_n_1aedca6bc5f821f5d9db70f5315ee9a85d" kindref="member">dat</ref>-&gt;<ref refid="struct_c_o_n_n_d_a_t_a_1a527ff688438cfc247e440d94467a5f48" kindref="member">out_bodydone</ref>=1;</highlight></codeline>
<codeline lineno="32"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="nullhttpd_8h_1ab95609803a250987eae69d66ec90dce8" kindref="member">flushbuffer</ref>(sid);</highlight></codeline>
<codeline lineno="33"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="nullhttpd_8h_1ac87891f3d1a4dea4eb2b539ae69000ba" kindref="member">closeconnect</ref>(sid,<sp/>1);</highlight></codeline>
<codeline lineno="34"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="35"><highlight class="normal">}</highlight></codeline>
<codeline lineno="36"><highlight class="normal"></highlight></codeline>
<codeline lineno="37"><highlight class="normal"></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="nullhttpd__http_8c_1ad8d0362486b46e83729c01a679de74ca" kindref="member">get_mime_type</ref>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*<ref refid="namespacemake_db_and_edl_1a2832407c256551abb325d5ee9e587443" kindref="member">name</ref>)</highlight></codeline>
<codeline lineno="38"><highlight class="normal">{</highlight></codeline>
<codeline lineno="39"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*mime_types[40][2]={</highlight></codeline>
<codeline lineno="40"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/></highlight><highlight class="stringliteral">&quot;.html&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;text/html&quot;</highlight><highlight class="normal"><sp/>},</highlight></codeline>
<codeline lineno="41"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/></highlight><highlight class="stringliteral">&quot;.htm&quot;</highlight><highlight class="normal">,<sp/><sp/></highlight><highlight class="stringliteral">&quot;text/html&quot;</highlight><highlight class="normal"><sp/>},</highlight></codeline>
<codeline lineno="42"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/></highlight><highlight class="stringliteral">&quot;.shtml&quot;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&quot;text/html&quot;</highlight><highlight class="normal"><sp/>},</highlight></codeline>
<codeline lineno="43"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/></highlight><highlight class="stringliteral">&quot;.css&quot;</highlight><highlight class="normal">,<sp/><sp/></highlight><highlight class="stringliteral">&quot;text/css&quot;</highlight><highlight class="normal"><sp/>},</highlight></codeline>
<codeline lineno="44"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/></highlight><highlight class="stringliteral">&quot;.txt&quot;</highlight><highlight class="normal">,<sp/><sp/></highlight><highlight class="stringliteral">&quot;text/plain&quot;</highlight><highlight class="normal"><sp/>},</highlight></codeline>
<codeline lineno="45"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/></highlight><highlight class="stringliteral">&quot;.mdb&quot;</highlight><highlight class="normal">,<sp/><sp/></highlight><highlight class="stringliteral">&quot;application/msaccess&quot;</highlight><highlight class="normal"><sp/>},</highlight></codeline>
<codeline lineno="46"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/></highlight><highlight class="stringliteral">&quot;.xls&quot;</highlight><highlight class="normal">,<sp/><sp/></highlight><highlight class="stringliteral">&quot;application/msexcel&quot;</highlight><highlight class="normal"><sp/>},</highlight></codeline>
<codeline lineno="47"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/></highlight><highlight class="stringliteral">&quot;.doc&quot;</highlight><highlight class="normal">,<sp/><sp/></highlight><highlight class="stringliteral">&quot;application/msword&quot;</highlight><highlight class="normal"><sp/>},</highlight></codeline>
<codeline lineno="48"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/></highlight><highlight class="stringliteral">&quot;.exe&quot;</highlight><highlight class="normal">,<sp/><sp/></highlight><highlight class="stringliteral">&quot;application/octet-stream&quot;</highlight><highlight class="normal"><sp/>},</highlight></codeline>
<codeline lineno="49"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/></highlight><highlight class="stringliteral">&quot;.pdf&quot;</highlight><highlight class="normal">,<sp/><sp/></highlight><highlight class="stringliteral">&quot;application/pdf&quot;</highlight><highlight class="normal"><sp/>},</highlight></codeline>
<codeline lineno="50"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/></highlight><highlight class="stringliteral">&quot;.rtf&quot;</highlight><highlight class="normal">,<sp/><sp/></highlight><highlight class="stringliteral">&quot;application/rtf&quot;</highlight><highlight class="normal"><sp/>},</highlight></codeline>
<codeline lineno="51"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/></highlight><highlight class="stringliteral">&quot;.tgz&quot;</highlight><highlight class="normal">,<sp/><sp/></highlight><highlight class="stringliteral">&quot;application/x-compressed&quot;</highlight><highlight class="normal"><sp/>},</highlight></codeline>
<codeline lineno="52"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/></highlight><highlight class="stringliteral">&quot;.gz&quot;</highlight><highlight class="normal">,<sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;application/x-compressed&quot;</highlight><highlight class="normal"><sp/>},</highlight></codeline>
<codeline lineno="53"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/></highlight><highlight class="stringliteral">&quot;.z&quot;</highlight><highlight class="normal">,<sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;application/x-compress&quot;</highlight><highlight class="normal"><sp/>},</highlight></codeline>
<codeline lineno="54"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/></highlight><highlight class="stringliteral">&quot;.swf&quot;</highlight><highlight class="normal">,<sp/><sp/></highlight><highlight class="stringliteral">&quot;application/x-shockwave-flash&quot;</highlight><highlight class="normal"><sp/>},</highlight></codeline>
<codeline lineno="55"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/></highlight><highlight class="stringliteral">&quot;.tar&quot;</highlight><highlight class="normal">,<sp/><sp/></highlight><highlight class="stringliteral">&quot;application/x-tar&quot;</highlight><highlight class="normal"><sp/>},</highlight></codeline>
<codeline lineno="56"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/></highlight><highlight class="stringliteral">&quot;.rar&quot;</highlight><highlight class="normal">,<sp/><sp/></highlight><highlight class="stringliteral">&quot;application/x-rar-compressed&quot;</highlight><highlight class="normal"><sp/>},</highlight></codeline>
<codeline lineno="57"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/></highlight><highlight class="stringliteral">&quot;.zip&quot;</highlight><highlight class="normal">,<sp/><sp/></highlight><highlight class="stringliteral">&quot;application/x-zip-compressed&quot;</highlight><highlight class="normal"><sp/>},</highlight></codeline>
<codeline lineno="58"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/></highlight><highlight class="stringliteral">&quot;.ra&quot;</highlight><highlight class="normal">,<sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;audio/x-pn-realaudio&quot;</highlight><highlight class="normal"><sp/>},</highlight></codeline>
<codeline lineno="59"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/></highlight><highlight class="stringliteral">&quot;.ram&quot;</highlight><highlight class="normal">,<sp/><sp/></highlight><highlight class="stringliteral">&quot;audio/x-pn-realaudio&quot;</highlight><highlight class="normal"><sp/>},</highlight></codeline>
<codeline lineno="60"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/></highlight><highlight class="stringliteral">&quot;.wav&quot;</highlight><highlight class="normal">,<sp/><sp/></highlight><highlight class="stringliteral">&quot;audio/x-wav&quot;</highlight><highlight class="normal"><sp/>},</highlight></codeline>
<codeline lineno="61"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/></highlight><highlight class="stringliteral">&quot;.gif&quot;</highlight><highlight class="normal">,<sp/><sp/></highlight><highlight class="stringliteral">&quot;image/gif&quot;</highlight><highlight class="normal"><sp/>},</highlight></codeline>
<codeline lineno="62"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/></highlight><highlight class="stringliteral">&quot;.jpeg&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;image/jpeg&quot;</highlight><highlight class="normal"><sp/>},</highlight></codeline>
<codeline lineno="63"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/></highlight><highlight class="stringliteral">&quot;.jpe&quot;</highlight><highlight class="normal">,<sp/><sp/></highlight><highlight class="stringliteral">&quot;image/jpeg&quot;</highlight><highlight class="normal"><sp/>},</highlight></codeline>
<codeline lineno="64"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/></highlight><highlight class="stringliteral">&quot;.jpg&quot;</highlight><highlight class="normal">,<sp/><sp/></highlight><highlight class="stringliteral">&quot;image/jpeg&quot;</highlight><highlight class="normal"><sp/>},</highlight></codeline>
<codeline lineno="65"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/></highlight><highlight class="stringliteral">&quot;.png&quot;</highlight><highlight class="normal">,<sp/><sp/></highlight><highlight class="stringliteral">&quot;image/png&quot;</highlight><highlight class="normal"><sp/>},</highlight></codeline>
<codeline lineno="66"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/></highlight><highlight class="stringliteral">&quot;.avi&quot;</highlight><highlight class="normal">,<sp/><sp/></highlight><highlight class="stringliteral">&quot;video/avi&quot;</highlight><highlight class="normal"><sp/>},</highlight></codeline>
<codeline lineno="67"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/></highlight><highlight class="stringliteral">&quot;.mp3&quot;</highlight><highlight class="normal">,<sp/><sp/></highlight><highlight class="stringliteral">&quot;video/mpeg&quot;</highlight><highlight class="normal"><sp/>},</highlight></codeline>
<codeline lineno="68"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/></highlight><highlight class="stringliteral">&quot;.mpeg&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;video/mpeg&quot;</highlight><highlight class="normal"><sp/>},</highlight></codeline>
<codeline lineno="69"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/></highlight><highlight class="stringliteral">&quot;.mpg&quot;</highlight><highlight class="normal">,<sp/><sp/></highlight><highlight class="stringliteral">&quot;video/mpeg&quot;</highlight><highlight class="normal"><sp/>},</highlight></codeline>
<codeline lineno="70"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/></highlight><highlight class="stringliteral">&quot;.qt&quot;</highlight><highlight class="normal">,<sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;video/quicktime&quot;</highlight><highlight class="normal"><sp/>},</highlight></codeline>
<codeline lineno="71"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/></highlight><highlight class="stringliteral">&quot;.mov&quot;</highlight><highlight class="normal">,<sp/><sp/></highlight><highlight class="stringliteral">&quot;video/quicktime&quot;</highlight><highlight class="normal"><sp/>},</highlight></codeline>
<codeline lineno="72"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{<sp/></highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal">,<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal"><sp/>}</highlight></codeline>
<codeline lineno="73"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>};</highlight></codeline>
<codeline lineno="74"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*extension;</highlight></codeline>
<codeline lineno="75"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="namespacemake_adl_1a518a859cd4b1663659f1e61fc40a2d30" kindref="member">i</ref>;</highlight></codeline>
<codeline lineno="76"><highlight class="normal"></highlight></codeline>
<codeline lineno="77"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>extension=strrchr(<ref refid="namespacemake_db_and_edl_1a2832407c256551abb325d5ee9e587443" kindref="member">name</ref>,<sp/></highlight><highlight class="charliteral">&apos;.&apos;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="78"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(extension==NULL)<sp/>{</highlight></codeline>
<codeline lineno="79"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;text/plain&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="80"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="81"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespacemake_adl_1a518a859cd4b1663659f1e61fc40a2d30" kindref="member">i</ref>=0;</highlight></codeline>
<codeline lineno="82"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(strlen(mime_types[<ref refid="namespacemake_adl_1a518a859cd4b1663659f1e61fc40a2d30" kindref="member">i</ref>][0])&gt;0)<sp/>{</highlight></codeline>
<codeline lineno="83"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(strcmp(extension,<sp/>mime_types[<ref refid="namespacemake_adl_1a518a859cd4b1663659f1e61fc40a2d30" kindref="member">i</ref>][0])==0)<sp/>{</highlight></codeline>
<codeline lineno="84"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>mime_types[<ref refid="namespacemake_adl_1a518a859cd4b1663659f1e61fc40a2d30" kindref="member">i</ref>][1];</highlight></codeline>
<codeline lineno="85"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="86"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespacemake_adl_1a518a859cd4b1663659f1e61fc40a2d30" kindref="member">i</ref>++;</highlight></codeline>
<codeline lineno="87"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="88"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;application/octet-stream&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="89"><highlight class="normal">}</highlight></codeline>
<codeline lineno="90"><highlight class="normal"></highlight></codeline>
<codeline lineno="91"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="nullhttpd__http_8c_1adb5da8c9918f106775943cf27a171a3b" kindref="member">ReadPOSTData</ref>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>sid)<sp/>{</highlight></codeline>
<codeline lineno="92"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*pPostData;</highlight></codeline>
<codeline lineno="93"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>rc=0;</highlight></codeline>
<codeline lineno="94"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="namespacemake_adl_1a75ac3107bf0f8a876fe96f2eed30eb15" kindref="member">x</ref>=0;</highlight></codeline>
<codeline lineno="95"><highlight class="normal"></highlight></codeline>
<codeline lineno="96"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].PostData!=NULL)<sp/>{</highlight></codeline>
<codeline lineno="97"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>free(<ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].PostData);</highlight></codeline>
<codeline lineno="98"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].<ref refid="struct_c_o_n_n_e_c_t_i_o_n_1a36c262e5f67ecd678aa264bfff4b5187" kindref="member">PostData</ref>=NULL;</highlight></codeline>
<codeline lineno="99"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="100"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].<ref refid="struct_c_o_n_n_e_c_t_i_o_n_1a36c262e5f67ecd678aa264bfff4b5187" kindref="member">PostData</ref>=calloc(<ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].dat-&gt;in_ContentLength+1024,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal">));</highlight></codeline>
<codeline lineno="101"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].PostData==NULL)<sp/>{</highlight></codeline>
<codeline lineno="102"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="nullhttpd_8h_1af1a3fad0fb9bfa5cd9083948f6c95de4" kindref="member">logerror</ref>(</highlight><highlight class="stringliteral">&quot;Memory<sp/>allocation<sp/>error<sp/>while<sp/>reading<sp/>POST<sp/>data.&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="nullhttpd_8h_1ac87891f3d1a4dea4eb2b539ae69000ba" kindref="member">closeconnect</ref>(sid,<sp/>1);</highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pPostData=<ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].<ref refid="struct_c_o_n_n_e_c_t_i_o_n_1a36c262e5f67ecd678aa264bfff4b5187" kindref="member">PostData</ref>;</highlight></codeline>
<codeline lineno="106"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>reading<sp/>beyond<sp/>PostContentLength<sp/>is<sp/>required<sp/>for<sp/>IE5.5<sp/>and<sp/>NS6<sp/>(HTTP<sp/>1.1)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="107"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">do</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="108"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rc=recv(<ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].<ref refid="structsocket" kindref="compound">socket</ref>,<sp/>pPostData,<sp/>1024,<sp/>0);</highlight></codeline>
<codeline lineno="109"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rc==-1)<sp/>{</highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="nullhttpd_8h_1ac87891f3d1a4dea4eb2b539ae69000ba" kindref="member">closeconnect</ref>(sid,<sp/>1);</highlight></codeline>
<codeline lineno="111"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pPostData+=rc;</highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespacemake_adl_1a75ac3107bf0f8a876fe96f2eed30eb15" kindref="member">x</ref>+=rc;</highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>((rc==1024)||(<ref refid="namespacemake_adl_1a75ac3107bf0f8a876fe96f2eed30eb15" kindref="member">x</ref>&lt;<ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].dat-&gt;in_ContentLength));</highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].<ref refid="struct_c_o_n_n_e_c_t_i_o_n_1a36c262e5f67ecd678aa264bfff4b5187" kindref="member">PostData</ref>[<ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].<ref refid="struct_c_o_n_n_e_c_t_i_o_n_1aedca6bc5f821f5d9db70f5315ee9a85d" kindref="member">dat</ref>-&gt;<ref refid="struct_c_o_n_n_d_a_t_a_1a607378ccb530cb63731100a12471b390" kindref="member">in_ContentLength</ref>]=</highlight><highlight class="charliteral">&apos;\0&apos;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="117"><highlight class="normal">}</highlight></codeline>
<codeline lineno="118"><highlight class="normal"></highlight></codeline>
<codeline lineno="119"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="nullhttpd__http_8c_1a1a9bc17fc2e0a0bf0fd9be63bf1faffc" kindref="member">read_header</ref>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>sid)</highlight></codeline>
<codeline lineno="120"><highlight class="normal">{</highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>line[2048];</highlight></codeline>
<codeline lineno="122"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*pTemp;</highlight></codeline>
<codeline lineno="123"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>time_t<sp/><ref refid="namespacemake_adl_1a75ac3107bf0f8a876fe96f2eed30eb15" kindref="member">x</ref>;</highlight></codeline>
<codeline lineno="124"><highlight class="normal"></highlight></codeline>
<codeline lineno="125"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>strncpy(<ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].dat-&gt;in_RemoteAddr,<sp/>inet_ntoa(<ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].ClientAddr.sin_addr),<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].<ref refid="struct_c_o_n_n_e_c_t_i_o_n_1aedca6bc5f821f5d9db70f5315ee9a85d" kindref="member">dat</ref>-&gt;<ref refid="struct_c_o_n_n_d_a_t_a_1a4c5f903693de65a1cd7e7ac2441acbce" kindref="member">in_RemoteAddr</ref>)-1);</highlight></codeline>
<codeline lineno="126"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespacemake_adl_1a75ac3107bf0f8a876fe96f2eed30eb15" kindref="member">x</ref>=time((time_t*)0);</highlight></codeline>
<codeline lineno="127"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">do</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>memset(line,<sp/>0,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(line));</highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(<ref refid="nullhttpd_8h_1aa0e8b1f823e122a6e0700b5141cf359a" kindref="member">sgets</ref>(line,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(line)-1,<sp/><ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].<ref refid="structsocket" kindref="compound">socket</ref>)<sp/>&lt;<sp/>0)</highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>We<sp/>really<sp/>should<sp/>handle<sp/>errors<sp/>etc.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="132"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="133"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="134"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="nullhttpd_8h_1a1773d4c515919ba03f301efe291097db" kindref="member">striprn</ref>(line);</highlight></codeline>
<codeline lineno="135"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>((strlen(line)==0)&amp;&amp;((time((time_t)0)-<ref refid="namespacemake_adl_1a75ac3107bf0f8a876fe96f2eed30eb15" kindref="member">x</ref>)&lt;30));</highlight></codeline>
<codeline lineno="136"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((strlen(line)==0)&amp;&amp;((time((time_t)0)-<ref refid="namespacemake_adl_1a75ac3107bf0f8a876fe96f2eed30eb15" kindref="member">x</ref>)&gt;=30))<sp/>{</highlight></codeline>
<codeline lineno="137"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>DEBUG</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="138"><highlight class="normal">logdata(</highlight><highlight class="stringliteral">&quot;\n[[[<sp/>KILLING<sp/>IDLE<sp/>KEEPALIVE<sp/>]]]\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="139"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="140"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="nullhttpd_8h_1ac87891f3d1a4dea4eb2b539ae69000ba" kindref="member">closeconnect</ref>(sid,<sp/>1);</highlight></codeline>
<codeline lineno="141"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="142"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>DEBUG</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="143"><highlight class="normal">logdata(</highlight><highlight class="stringliteral">&quot;\n[[[<sp/>STARTING<sp/>REQUEST<sp/>]]]\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="144"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(strlen(line)==0)</highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="nullhttpd__http_8c_1ad4a81cea18f472f3df2e85494113dcc5" kindref="member">printerror</ref>(sid,<sp/>400,<sp/></highlight><highlight class="stringliteral">&quot;Bad<sp/>Request&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;No<sp/>Request<sp/>Found.&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(sscanf(line,<sp/></highlight><highlight class="stringliteral">&quot;%[^<sp/>]<sp/>%[^<sp/>]<sp/>%[^<sp/>]&quot;</highlight><highlight class="normal">,<sp/><ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].dat-&gt;in_RequestMethod,<sp/><ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].<ref refid="struct_c_o_n_n_e_c_t_i_o_n_1aedca6bc5f821f5d9db70f5315ee9a85d" kindref="member">dat</ref>-&gt;<ref refid="struct_c_o_n_n_d_a_t_a_1a5a732ad9e24afbf9ce90e0ddf08cd6a3" kindref="member">in_RequestURI</ref>,<sp/><ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].<ref refid="struct_c_o_n_n_e_c_t_i_o_n_1aedca6bc5f821f5d9db70f5315ee9a85d" kindref="member">dat</ref>-&gt;<ref refid="struct_c_o_n_n_d_a_t_a_1a48666c1cd86684cca694170327b98f0c" kindref="member">in_Protocol</ref>)!=3)</highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="nullhttpd__http_8c_1ad4a81cea18f472f3df2e85494113dcc5" kindref="member">printerror</ref>(sid,<sp/>400,<sp/></highlight><highlight class="stringliteral">&quot;Bad<sp/>Request&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;Can&apos;t<sp/>Parse<sp/>Request.&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTemp=<ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].<ref refid="struct_c_o_n_n_e_c_t_i_o_n_1aedca6bc5f821f5d9db70f5315ee9a85d" kindref="member">dat</ref>-&gt;<ref refid="struct_c_o_n_n_d_a_t_a_1ae280c6c8a40fae68c9e564f90ea1d388" kindref="member">in_RequestMethod</ref>;</highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(*pTemp)<sp/>{<sp/>*pTemp=toupper(*pTemp);<sp/>pTemp++;<sp/>};</highlight></codeline>
<codeline lineno="151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(strlen(line)&gt;0)<sp/>{</highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="nullhttpd_8h_1aa0e8b1f823e122a6e0700b5141cf359a" kindref="member">sgets</ref>(line,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(line)-1,<sp/><ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].<ref refid="structsocket" kindref="compound">socket</ref>);</highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>((line[strlen(line)-1]==</highlight><highlight class="charliteral">&apos;\n&apos;</highlight><highlight class="normal">)||(line[strlen(line)-1]==</highlight><highlight class="charliteral">&apos;\r&apos;</highlight><highlight class="normal">))<sp/>line[strlen(line)-1]=</highlight><highlight class="charliteral">&apos;\0&apos;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(strncasecmp(line,<sp/></highlight><highlight class="stringliteral">&quot;Connection:<sp/>&quot;</highlight><highlight class="normal">,<sp/>12)==0)</highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>strncpy(<ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].dat-&gt;in_Connection,<sp/>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*)&amp;line+12,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].<ref refid="struct_c_o_n_n_e_c_t_i_o_n_1aedca6bc5f821f5d9db70f5315ee9a85d" kindref="member">dat</ref>-&gt;<ref refid="struct_c_o_n_n_d_a_t_a_1a9c633b7e35ed8aa7b7172fb755fc9638" kindref="member">in_Connection</ref>)-1);</highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(strncasecmp(line,<sp/></highlight><highlight class="stringliteral">&quot;Content-Length:<sp/>&quot;</highlight><highlight class="normal">,<sp/>16)==0)<sp/>{</highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].<ref refid="struct_c_o_n_n_e_c_t_i_o_n_1aedca6bc5f821f5d9db70f5315ee9a85d" kindref="member">dat</ref>-&gt;<ref refid="struct_c_o_n_n_d_a_t_a_1a607378ccb530cb63731100a12471b390" kindref="member">in_ContentLength</ref>=atoi((</highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*)&amp;line+16);</highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].dat-&gt;in_ContentLength&lt;0)<sp/>{</highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Negative<sp/>Content-Length?<sp/><sp/>If<sp/>so,<sp/>the<sp/>client<sp/>is<sp/>either<sp/>broken<sp/>or<sp/>malicious.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Thanks<sp/>to<sp/>&lt;ilja@idefense.be&gt;<sp/>for<sp/>spotting<sp/>this<sp/>one.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="nullhttpd_8h_1af1a3fad0fb9bfa5cd9083948f6c95de4" kindref="member">logerror</ref>(</highlight><highlight class="stringliteral">&quot;ERROR:<sp/>negative<sp/>Content-Length<sp/>of<sp/>%d<sp/>provided<sp/>by<sp/>client.&quot;</highlight><highlight class="normal">,<sp/><ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].dat-&gt;in_ContentLength);</highlight></codeline>
<codeline lineno="162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].<ref refid="struct_c_o_n_n_e_c_t_i_o_n_1aedca6bc5f821f5d9db70f5315ee9a85d" kindref="member">dat</ref>-&gt;<ref refid="struct_c_o_n_n_d_a_t_a_1a607378ccb530cb63731100a12471b390" kindref="member">in_ContentLength</ref>=0;</highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(strncasecmp(line,<sp/></highlight><highlight class="stringliteral">&quot;Cookie:<sp/>&quot;</highlight><highlight class="normal">,<sp/>8)==0)</highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>strncpy(<ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].dat-&gt;in_Cookie,<sp/>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*)&amp;line+8,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].<ref refid="struct_c_o_n_n_e_c_t_i_o_n_1aedca6bc5f821f5d9db70f5315ee9a85d" kindref="member">dat</ref>-&gt;<ref refid="struct_c_o_n_n_d_a_t_a_1a062830219deb31a1e007cf3026159379" kindref="member">in_Cookie</ref>)-1);</highlight></codeline>
<codeline lineno="167"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(strncasecmp(line,<sp/></highlight><highlight class="stringliteral">&quot;Host:<sp/>&quot;</highlight><highlight class="normal">,<sp/>6)==0)</highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>strncpy(<ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].dat-&gt;in_Host,<sp/>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*)&amp;line+6,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].<ref refid="struct_c_o_n_n_e_c_t_i_o_n_1aedca6bc5f821f5d9db70f5315ee9a85d" kindref="member">dat</ref>-&gt;<ref refid="struct_c_o_n_n_d_a_t_a_1a95f39012f1051f94b0acb2873b847df1" kindref="member">in_Host</ref>)-1);</highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(strncasecmp(line,<sp/></highlight><highlight class="stringliteral">&quot;If-Modified-Since:<sp/>&quot;</highlight><highlight class="normal">,<sp/>19)==0)</highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>strncpy(<ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].dat-&gt;in_IfModifiedSince,<sp/>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*)&amp;line+19,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].<ref refid="struct_c_o_n_n_e_c_t_i_o_n_1aedca6bc5f821f5d9db70f5315ee9a85d" kindref="member">dat</ref>-&gt;<ref refid="struct_c_o_n_n_d_a_t_a_1a594ff48304cfdd9778011f1caa9ee045" kindref="member">in_IfModifiedSince</ref>)-1);</highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(strncasecmp(line,<sp/></highlight><highlight class="stringliteral">&quot;User-Agent:<sp/>&quot;</highlight><highlight class="normal">,<sp/>12)==0)</highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>strncpy(<ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].dat-&gt;in_UserAgent,<sp/>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*)&amp;line+12,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].<ref refid="struct_c_o_n_n_e_c_t_i_o_n_1aedca6bc5f821f5d9db70f5315ee9a85d" kindref="member">dat</ref>-&gt;<ref refid="struct_c_o_n_n_d_a_t_a_1accd3614f45b6c7bd910a885ac5713d3d" kindref="member">in_UserAgent</ref>)-1);</highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((strcmp(<ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].dat-&gt;in_RequestMethod,<sp/></highlight><highlight class="stringliteral">&quot;GET&quot;</highlight><highlight class="normal">)!=0)&amp;&amp;(strcmp(<ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].dat-&gt;in_RequestMethod,<sp/></highlight><highlight class="stringliteral">&quot;POST&quot;</highlight><highlight class="normal">)!=0))<sp/>{</highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="nullhttpd__http_8c_1ad4a81cea18f472f3df2e85494113dcc5" kindref="member">printerror</ref>(sid,<sp/>501,<sp/></highlight><highlight class="stringliteral">&quot;Not<sp/>Implemented&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;That<sp/>method<sp/>is<sp/>not<sp/>implemented.&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="nullhttpd_8h_1ac87891f3d1a4dea4eb2b539ae69000ba" kindref="member">closeconnect</ref>(sid,<sp/>1);</highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(strcmp(<ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].dat-&gt;in_RequestMethod,<sp/></highlight><highlight class="stringliteral">&quot;POST&quot;</highlight><highlight class="normal">)==0)<sp/>{</highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].dat-&gt;in_ContentLength&lt;<ref refid="nullhttpd_8h_1ae0e4361c773b78dc46ba9ee363fe2c2c" kindref="member">MAX_POSTSIZE</ref>)<sp/>{</highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="nullhttpd__http_8c_1adb5da8c9918f106775943cf27a171a3b" kindref="member">ReadPOSTData</ref>(sid);</highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>try<sp/>to<sp/>print<sp/>an<sp/>error<sp/>:<sp/>note<sp/>the<sp/>inbuffer<sp/>being<sp/>full<sp/>may<sp/>block<sp/>us</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="184"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>FIXME:<sp/>this<sp/>is<sp/>causing<sp/>the<sp/>children<sp/>to<sp/>segfault<sp/>in<sp/>win32</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="nullhttpd__http_8c_1ad4a81cea18f472f3df2e85494113dcc5" kindref="member">printerror</ref>(sid,<sp/>413,<sp/></highlight><highlight class="stringliteral">&quot;Bad<sp/>Request&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;Request<sp/>entity<sp/>too<sp/>large.&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="nullhttpd_8h_1af1a3fad0fb9bfa5cd9083948f6c95de4" kindref="member">logerror</ref>(</highlight><highlight class="stringliteral">&quot;%s<sp/>-<sp/>Large<sp/>POST<sp/>(&gt;%d<sp/>bytes)<sp/>disallowed&quot;</highlight><highlight class="normal">,<sp/><ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].dat-&gt;in_RemoteAddr,<sp/><ref refid="nullhttpd_8h_1ae0e4361c773b78dc46ba9ee363fe2c2c" kindref="member">MAX_POSTSIZE</ref>);</highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="nullhttpd_8h_1ac87891f3d1a4dea4eb2b539ae69000ba" kindref="member">closeconnect</ref>(sid,<sp/>1);</highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="190"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].dat-&gt;in_RequestURI[0]!=</highlight><highlight class="charliteral">&apos;/&apos;</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="nullhttpd__http_8c_1ad4a81cea18f472f3df2e85494113dcc5" kindref="member">printerror</ref>(sid,<sp/>400,<sp/></highlight><highlight class="stringliteral">&quot;Bad<sp/>Request&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;Bad<sp/>filename.&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="194"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(strchr(<ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].dat-&gt;in_RequestURI,<sp/></highlight><highlight class="charliteral">&apos;?&apos;</highlight><highlight class="normal">)!=NULL)<sp/>{</highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>strncpy(<ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].dat-&gt;in_QueryString,<sp/>strchr(<ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].dat-&gt;in_RequestURI,<sp/></highlight><highlight class="charliteral">&apos;?&apos;</highlight><highlight class="normal">)+1,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].<ref refid="struct_c_o_n_n_e_c_t_i_o_n_1aedca6bc5f821f5d9db70f5315ee9a85d" kindref="member">dat</ref>-&gt;<ref refid="struct_c_o_n_n_d_a_t_a_1a2419bbc4c2d9829c0f72fd921822ebe2" kindref="member">in_QueryString</ref>)-1);</highlight></codeline>
<codeline lineno="196"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="197"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="198"><highlight class="normal">}</highlight></codeline>
<codeline lineno="199"><highlight class="normal"></highlight></codeline>
<codeline lineno="200"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="nullhttpd__http_8c_1aed2a33b5bb684d7b757196a9c32a9fee" kindref="member">send_header</ref>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>sid,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>cacheable,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>status,<sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*title,<sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*extra_header,<sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*mime_type,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>length,<sp/>time_t<sp/>mod)</highlight></codeline>
<codeline lineno="201"><highlight class="normal">{</highlight></codeline>
<codeline lineno="202"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>timebuf[100];</highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>time_t<sp/>now;</highlight></codeline>
<codeline lineno="204"><highlight class="normal"></highlight></codeline>
<codeline lineno="205"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(status)<sp/>{</highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].<ref refid="struct_c_o_n_n_e_c_t_i_o_n_1aedca6bc5f821f5d9db70f5315ee9a85d" kindref="member">dat</ref>-&gt;<ref refid="struct_c_o_n_n_d_a_t_a_1a86d706606e48f7001c1f317c13b9154a" kindref="member">out_status</ref>=status;</highlight></codeline>
<codeline lineno="207"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="208"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].<ref refid="struct_c_o_n_n_e_c_t_i_o_n_1aedca6bc5f821f5d9db70f5315ee9a85d" kindref="member">dat</ref>-&gt;<ref refid="struct_c_o_n_n_d_a_t_a_1a86d706606e48f7001c1f317c13b9154a" kindref="member">out_status</ref>=200;</highlight></codeline>
<codeline lineno="209"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="210"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(length&gt;=0)<sp/>{</highlight></codeline>
<codeline lineno="211"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].<ref refid="struct_c_o_n_n_e_c_t_i_o_n_1aedca6bc5f821f5d9db70f5315ee9a85d" kindref="member">dat</ref>-&gt;<ref refid="struct_c_o_n_n_d_a_t_a_1a2ee16182dd3131dda674a22be01ba286" kindref="member">out_ContentLength</ref>=length;</highlight></codeline>
<codeline lineno="212"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="213"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(mod!=(time_t)-1)<sp/>{</highlight></codeline>
<codeline lineno="214"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>strftime(timebuf,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(timebuf),<sp/><ref refid="nullhttpd__http_8c_1ad435f7aea25c4470de2a2250d5b85369" kindref="member">RFC1123FMT</ref>,<sp/>gmtime(&amp;mod));</highlight></codeline>
<codeline lineno="215"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>snprintf(<ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].dat-&gt;out_LastModified,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].<ref refid="struct_c_o_n_n_e_c_t_i_o_n_1aedca6bc5f821f5d9db70f5315ee9a85d" kindref="member">dat</ref>-&gt;<ref refid="struct_c_o_n_n_d_a_t_a_1a74ec1ef052486d6b70d220844aa1c025" kindref="member">out_LastModified</ref>)-1,<sp/></highlight><highlight class="stringliteral">&quot;%s&quot;</highlight><highlight class="normal">,<sp/>timebuf);</highlight></codeline>
<codeline lineno="216"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="217"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>now=time((time_t*)0);</highlight></codeline>
<codeline lineno="218"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>strftime(timebuf,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(timebuf),<sp/><ref refid="nullhttpd__http_8c_1ad435f7aea25c4470de2a2250d5b85369" kindref="member">RFC1123FMT</ref>,<sp/>gmtime(&amp;now));</highlight></codeline>
<codeline lineno="219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>snprintf(<ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].dat-&gt;out_Date,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].<ref refid="struct_c_o_n_n_e_c_t_i_o_n_1aedca6bc5f821f5d9db70f5315ee9a85d" kindref="member">dat</ref>-&gt;<ref refid="struct_c_o_n_n_d_a_t_a_1a4a0a0599d7ac5da9b84af7d801fbe032" kindref="member">out_Date</ref>)-1,<sp/></highlight><highlight class="stringliteral">&quot;%s&quot;</highlight><highlight class="normal">,<sp/>timebuf);</highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(cacheable)<sp/>{</highlight></codeline>
<codeline lineno="221"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>snprintf(<ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].dat-&gt;out_CacheControl,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].<ref refid="struct_c_o_n_n_e_c_t_i_o_n_1aedca6bc5f821f5d9db70f5315ee9a85d" kindref="member">dat</ref>-&gt;<ref refid="struct_c_o_n_n_d_a_t_a_1ac27ec882f43ff11f386776d129afb36e" kindref="member">out_CacheControl</ref>)-1,<sp/></highlight><highlight class="stringliteral">&quot;public&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>snprintf(<ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].dat-&gt;out_Pragma,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].<ref refid="struct_c_o_n_n_e_c_t_i_o_n_1aedca6bc5f821f5d9db70f5315ee9a85d" kindref="member">dat</ref>-&gt;<ref refid="struct_c_o_n_n_d_a_t_a_1ad2d22dad559ba9a887e11baa72c1f6c7" kindref="member">out_Pragma</ref>)-1,<sp/></highlight><highlight class="stringliteral">&quot;public&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="223"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="224"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>snprintf(<ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].dat-&gt;out_CacheControl,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].<ref refid="struct_c_o_n_n_e_c_t_i_o_n_1aedca6bc5f821f5d9db70f5315ee9a85d" kindref="member">dat</ref>-&gt;<ref refid="struct_c_o_n_n_d_a_t_a_1ac27ec882f43ff11f386776d129afb36e" kindref="member">out_CacheControl</ref>)-1,<sp/></highlight><highlight class="stringliteral">&quot;no-store&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>snprintf(<ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].dat-&gt;out_Expires,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].<ref refid="struct_c_o_n_n_e_c_t_i_o_n_1aedca6bc5f821f5d9db70f5315ee9a85d" kindref="member">dat</ref>-&gt;<ref refid="struct_c_o_n_n_d_a_t_a_1a36079521f8caa59faa69f8b9594ccf6d" kindref="member">out_Expires</ref>)-1,<sp/></highlight><highlight class="stringliteral">&quot;%s&quot;</highlight><highlight class="normal">,<sp/>timebuf);</highlight></codeline>
<codeline lineno="226"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>snprintf(<ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].dat-&gt;out_Pragma,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].<ref refid="struct_c_o_n_n_e_c_t_i_o_n_1aedca6bc5f821f5d9db70f5315ee9a85d" kindref="member">dat</ref>-&gt;<ref refid="struct_c_o_n_n_d_a_t_a_1ad2d22dad559ba9a887e11baa72c1f6c7" kindref="member">out_Pragma</ref>)-1,<sp/></highlight><highlight class="stringliteral">&quot;no-cache&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="227"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="228"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(extra_header!=(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*)0)<sp/>{</highlight></codeline>
<codeline lineno="229"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>snprintf(<ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].dat-&gt;out_ContentType,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].<ref refid="struct_c_o_n_n_e_c_t_i_o_n_1aedca6bc5f821f5d9db70f5315ee9a85d" kindref="member">dat</ref>-&gt;<ref refid="struct_c_o_n_n_d_a_t_a_1a7f5562994e80d19c7c34883629744ec3" kindref="member">out_ContentType</ref>)-1,<sp/></highlight><highlight class="stringliteral">&quot;%s&quot;</highlight><highlight class="normal">,<sp/>mime_type);</highlight></codeline>
<codeline lineno="230"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>snprintf(<ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].dat-&gt;out_ContentType,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].<ref refid="struct_c_o_n_n_e_c_t_i_o_n_1aedca6bc5f821f5d9db70f5315ee9a85d" kindref="member">dat</ref>-&gt;<ref refid="struct_c_o_n_n_d_a_t_a_1a7f5562994e80d19c7c34883629744ec3" kindref="member">out_ContentType</ref>)-1,<sp/></highlight><highlight class="stringliteral">&quot;text/html&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="232"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="233"><highlight class="normal">}</highlight></codeline>
<codeline lineno="234"><highlight class="normal"></highlight></codeline>
<codeline lineno="235"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="nullhttpd__http_8c_1a02debcd1a761c6a92250717ab540b0c0" kindref="member">send_fileheader</ref>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>sid,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>cacheable,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>status,<sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*title,<sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*extra_header,<sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*mime_type,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>length,<sp/>time_t<sp/>mod)</highlight></codeline>
<codeline lineno="236"><highlight class="normal">{</highlight></codeline>
<codeline lineno="237"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>timebuf[100];</highlight></codeline>
<codeline lineno="238"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>time_t<sp/>now;</highlight></codeline>
<codeline lineno="239"><highlight class="normal"></highlight></codeline>
<codeline lineno="240"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(status)<sp/>{</highlight></codeline>
<codeline lineno="241"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].<ref refid="struct_c_o_n_n_e_c_t_i_o_n_1aedca6bc5f821f5d9db70f5315ee9a85d" kindref="member">dat</ref>-&gt;<ref refid="struct_c_o_n_n_d_a_t_a_1a86d706606e48f7001c1f317c13b9154a" kindref="member">out_status</ref>=status;</highlight></codeline>
<codeline lineno="242"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="243"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].<ref refid="struct_c_o_n_n_e_c_t_i_o_n_1aedca6bc5f821f5d9db70f5315ee9a85d" kindref="member">dat</ref>-&gt;<ref refid="struct_c_o_n_n_d_a_t_a_1a86d706606e48f7001c1f317c13b9154a" kindref="member">out_status</ref>=200;</highlight></codeline>
<codeline lineno="244"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="245"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="nullhttpd_8h_1a41a44bdb3e2cc1c3a62ef58e7a487957" kindref="member">nullhttpd_strcasestr</ref>(<ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].dat-&gt;in_Protocol,<sp/></highlight><highlight class="stringliteral">&quot;HTTP/1.1&quot;</highlight><highlight class="normal">)!=NULL)<sp/>{</highlight></codeline>
<codeline lineno="246"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>snprintf(<ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].dat-&gt;out_Protocol,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].<ref refid="struct_c_o_n_n_e_c_t_i_o_n_1aedca6bc5f821f5d9db70f5315ee9a85d" kindref="member">dat</ref>-&gt;<ref refid="struct_c_o_n_n_d_a_t_a_1a46393de0d76b7790412fef7853c540cc" kindref="member">out_Protocol</ref>)-1,<sp/></highlight><highlight class="stringliteral">&quot;HTTP/1.1&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="247"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="248"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>snprintf(<ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].dat-&gt;out_Protocol,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].<ref refid="struct_c_o_n_n_e_c_t_i_o_n_1aedca6bc5f821f5d9db70f5315ee9a85d" kindref="member">dat</ref>-&gt;<ref refid="struct_c_o_n_n_d_a_t_a_1a46393de0d76b7790412fef7853c540cc" kindref="member">out_Protocol</ref>)-1,<sp/></highlight><highlight class="stringliteral">&quot;HTTP/1.0&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="249"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="250"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(strcasecmp(<ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].dat-&gt;in_Connection,<sp/></highlight><highlight class="stringliteral">&quot;Keep-Alive&quot;</highlight><highlight class="normal">)==0)<sp/>{</highlight></codeline>
<codeline lineno="251"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>snprintf(<ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].dat-&gt;out_Connection,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].<ref refid="struct_c_o_n_n_e_c_t_i_o_n_1aedca6bc5f821f5d9db70f5315ee9a85d" kindref="member">dat</ref>-&gt;<ref refid="struct_c_o_n_n_d_a_t_a_1ae3ce6b71a007a0e95e25fc86e6583bda" kindref="member">out_Connection</ref>)-1,<sp/></highlight><highlight class="stringliteral">&quot;Keep-Alive&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="252"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="253"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>snprintf(<ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].dat-&gt;out_Connection,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].<ref refid="struct_c_o_n_n_e_c_t_i_o_n_1aedca6bc5f821f5d9db70f5315ee9a85d" kindref="member">dat</ref>-&gt;<ref refid="struct_c_o_n_n_d_a_t_a_1ae3ce6b71a007a0e95e25fc86e6583bda" kindref="member">out_Connection</ref>)-1,<sp/></highlight><highlight class="stringliteral">&quot;Close&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="254"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="255"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Keepalive<sp/>workaround<sp/>for<sp/>Mozilla/Netscape</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="256"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((<ref refid="nullhttpd_8h_1a41a44bdb3e2cc1c3a62ef58e7a487957" kindref="member">nullhttpd_strcasestr</ref>(<ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].dat-&gt;in_UserAgent,<sp/></highlight><highlight class="stringliteral">&quot;MSIE&quot;</highlight><highlight class="normal">)==NULL))<sp/>{</highlight></codeline>
<codeline lineno="257"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>snprintf(<ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].dat-&gt;out_Connection,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].<ref refid="struct_c_o_n_n_e_c_t_i_o_n_1aedca6bc5f821f5d9db70f5315ee9a85d" kindref="member">dat</ref>-&gt;<ref refid="struct_c_o_n_n_d_a_t_a_1ae3ce6b71a007a0e95e25fc86e6583bda" kindref="member">out_Connection</ref>)-1,<sp/></highlight><highlight class="stringliteral">&quot;Close&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="258"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="259"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="nullhttpd_8h_1a5d3bd1a7f401fdd0efae6fdb4280e0fb" kindref="member">prints</ref>(</highlight><highlight class="stringliteral">&quot;%s<sp/>%d<sp/>OK\r\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].dat-&gt;out_Protocol,<sp/><ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].<ref refid="struct_c_o_n_n_e_c_t_i_o_n_1aedca6bc5f821f5d9db70f5315ee9a85d" kindref="member">dat</ref>-&gt;<ref refid="struct_c_o_n_n_d_a_t_a_1a86d706606e48f7001c1f317c13b9154a" kindref="member">out_status</ref>);</highlight></codeline>
<codeline lineno="260"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="nullhttpd_8h_1a5d3bd1a7f401fdd0efae6fdb4280e0fb" kindref="member">prints</ref>(</highlight><highlight class="stringliteral">&quot;Connection:<sp/>%s\r\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].dat-&gt;out_Connection);</highlight></codeline>
<codeline lineno="261"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="nullhttpd_8h_1a5d3bd1a7f401fdd0efae6fdb4280e0fb" kindref="member">prints</ref>(</highlight><highlight class="stringliteral">&quot;Server:<sp/>%s\r\n&quot;</highlight><highlight class="normal">,<sp/><ref refid="nullhttpd_8h_1af00aa3c79fe31d435739c34e4c989835" kindref="member">SERVER_NAME</ref>);</highlight></codeline>
<codeline lineno="262"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((length&gt;=0)&amp;&amp;(status!=304))<sp/>{</highlight></codeline>
<codeline lineno="263"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="nullhttpd_8h_1a5d3bd1a7f401fdd0efae6fdb4280e0fb" kindref="member">prints</ref>(</highlight><highlight class="stringliteral">&quot;Content-Length:<sp/>%d\r\n&quot;</highlight><highlight class="normal">,<sp/>length);</highlight></codeline>
<codeline lineno="264"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="265"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>now=time((time_t*)0);</highlight></codeline>
<codeline lineno="266"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>strftime(timebuf,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(timebuf),<sp/><ref refid="nullhttpd__http_8c_1ad435f7aea25c4470de2a2250d5b85369" kindref="member">RFC1123FMT</ref>,<sp/>gmtime(&amp;now));</highlight></codeline>
<codeline lineno="267"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="nullhttpd_8h_1a5d3bd1a7f401fdd0efae6fdb4280e0fb" kindref="member">prints</ref>(</highlight><highlight class="stringliteral">&quot;Date:<sp/>%s\r\n&quot;</highlight><highlight class="normal">,<sp/>timebuf);</highlight></codeline>
<codeline lineno="268"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(mod!=(time_t)-1)<sp/>{</highlight></codeline>
<codeline lineno="269"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>strftime(timebuf,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(timebuf),<sp/><ref refid="nullhttpd__http_8c_1ad435f7aea25c4470de2a2250d5b85369" kindref="member">RFC1123FMT</ref>,<sp/>gmtime(&amp;mod));</highlight></codeline>
<codeline lineno="270"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="nullhttpd_8h_1a5d3bd1a7f401fdd0efae6fdb4280e0fb" kindref="member">prints</ref>(</highlight><highlight class="stringliteral">&quot;Last-Modified:<sp/>%s\r\n&quot;</highlight><highlight class="normal">,<sp/>timebuf);</highlight></codeline>
<codeline lineno="271"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="272"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(cacheable)<sp/>{</highlight></codeline>
<codeline lineno="273"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>now=time((time_t*)0)+604800;</highlight></codeline>
<codeline lineno="274"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>strftime(timebuf,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(timebuf),<sp/><ref refid="nullhttpd__http_8c_1ad435f7aea25c4470de2a2250d5b85369" kindref="member">RFC1123FMT</ref>,<sp/>gmtime(&amp;now));</highlight></codeline>
<codeline lineno="275"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="nullhttpd_8h_1a5d3bd1a7f401fdd0efae6fdb4280e0fb" kindref="member">prints</ref>(</highlight><highlight class="stringliteral">&quot;Expires:<sp/>%s\r\n&quot;</highlight><highlight class="normal">,<sp/>timebuf);</highlight></codeline>
<codeline lineno="276"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="nullhttpd_8h_1a5d3bd1a7f401fdd0efae6fdb4280e0fb" kindref="member">prints</ref>(</highlight><highlight class="stringliteral">&quot;Cache-Control:<sp/>public\r\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="277"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="nullhttpd_8h_1a5d3bd1a7f401fdd0efae6fdb4280e0fb" kindref="member">prints</ref>(</highlight><highlight class="stringliteral">&quot;Pragma:<sp/>public\r\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="278"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="279"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>now=time((time_t*)0);</highlight></codeline>
<codeline lineno="280"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>strftime(timebuf,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(timebuf),<sp/><ref refid="nullhttpd__http_8c_1ad435f7aea25c4470de2a2250d5b85369" kindref="member">RFC1123FMT</ref>,<sp/>gmtime(&amp;now));</highlight></codeline>
<codeline lineno="281"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="nullhttpd_8h_1a5d3bd1a7f401fdd0efae6fdb4280e0fb" kindref="member">prints</ref>(</highlight><highlight class="stringliteral">&quot;Expires:<sp/>%s\r\n&quot;</highlight><highlight class="normal">,<sp/>timebuf);</highlight></codeline>
<codeline lineno="282"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="nullhttpd_8h_1a5d3bd1a7f401fdd0efae6fdb4280e0fb" kindref="member">prints</ref>(</highlight><highlight class="stringliteral">&quot;Cache-Control:<sp/>no-store,<sp/>no-cache,<sp/>must-revalidate,<sp/>pre-check=0,<sp/>post-check=0,<sp/>max-age=0\r\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="283"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="nullhttpd_8h_1a5d3bd1a7f401fdd0efae6fdb4280e0fb" kindref="member">prints</ref>(</highlight><highlight class="stringliteral">&quot;Pragma:<sp/>no-cache\r\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="284"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="285"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(extra_header!=(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*)0)<sp/>{</highlight></codeline>
<codeline lineno="286"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="nullhttpd_8h_1a5d3bd1a7f401fdd0efae6fdb4280e0fb" kindref="member">prints</ref>(</highlight><highlight class="stringliteral">&quot;Content-Type:<sp/>%s\r\n\r\n&quot;</highlight><highlight class="normal">,<sp/>mime_type);</highlight></codeline>
<codeline lineno="287"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="288"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="nullhttpd_8h_1a5d3bd1a7f401fdd0efae6fdb4280e0fb" kindref="member">prints</ref>(</highlight><highlight class="stringliteral">&quot;Content-Type:<sp/>text/html\r\n\r\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="289"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="290"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="nullhttpd_8h_1a525d7eccda3aaf37a79ce3854365b295" kindref="member">conn</ref>[sid].<ref refid="struct_c_o_n_n_e_c_t_i_o_n_1aedca6bc5f821f5d9db70f5315ee9a85d" kindref="member">dat</ref>-&gt;<ref refid="struct_c_o_n_n_d_a_t_a_1abdeba9c8665c56d25f9268f0ad98bd04" kindref="member">out_headdone</ref>=1;</highlight></codeline>
<codeline lineno="291"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="nullhttpd_8h_1ab95609803a250987eae69d66ec90dce8" kindref="member">flushbuffer</ref>(sid);</highlight></codeline>
<codeline lineno="292"><highlight class="normal">}</highlight></codeline>
    </programlisting>
    <location file="/home/runner/work/areaDetector/areaDetector/ffmpegServer/ffmpegServerApp/src/nullhttpd_http.c"/>
  </compounddef>
</doxygen>
