<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>NDPluginColorConvert &mdash; areaDetector Support</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme_overrides.css?v=254ed751" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="NDPluginFFT" href="NDPluginFFT.html" />
    <link rel="prev" title="NDPluginCodec" href="NDPluginCodec.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            areaDetector
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../readme.html">Readme</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../user_guide.html">User Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="arch.html">Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="asynPortDriver.html">asynPortDriver</a></li>
<li class="toctree-l2"><a class="reference internal" href="NDArray.html">NDArray</a></li>
<li class="toctree-l2"><a class="reference internal" href="../detector_drivers.html">Detector Drivers</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="plugins.html">areaDetector Plugins</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="plugin_overview.html">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="NDPluginDriver.html">NDPluginDriver</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugin_guidelines.html">Guidelines and rules for plugins</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugin_medm.html">Base class medm screens</a></li>
<li class="toctree-l3"><a class="reference internal" href="common_plugins.html">commonPlugins.cmd</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugin_performance.html">Performance example</a></li>
<li class="toctree-l3"><a class="reference internal" href="NDPluginAttrPlot.html">NDPluginAttrPlot</a></li>
<li class="toctree-l3"><a class="reference internal" href="NDPluginAttribute.html">NDPluginAttribute</a></li>
<li class="toctree-l3"><a class="reference internal" href="NDPluginBadPixel.html">NDPluginBadPixel</a></li>
<li class="toctree-l3"><a class="reference internal" href="NDPluginCircularBuff.html">NDPluginCircularBuff</a></li>
<li class="toctree-l3"><a class="reference internal" href="NDPluginCodec.html">NDPluginCodec</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">NDPluginColorConvert</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configuration">Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#screen-shots">Screen shots</a></li>
<li class="toctree-l4"><a class="reference internal" href="#performance">Performance</a></li>
<li class="toctree-l4"><a class="reference internal" href="#restrictions">Restrictions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="NDPluginFFT.html">NDPluginFFT</a></li>
<li class="toctree-l3"><a class="reference internal" href="NDPluginFile.html">NDPluginFile</a></li>
<li class="toctree-l3"><a class="reference internal" href="NDPluginGather.html">NDPluginGather</a></li>
<li class="toctree-l3"><a class="reference internal" href="NDPluginOverlay.html">NDPluginOverlay</a></li>
<li class="toctree-l3"><a class="reference internal" href="NDPluginProcess.html">NDPluginProcess</a></li>
<li class="toctree-l3"><a class="reference internal" href="NDPluginPva.html">NDPluginPva</a></li>
<li class="toctree-l3"><a class="reference internal" href="NDPluginROI.html">NDPluginROI</a></li>
<li class="toctree-l3"><a class="reference internal" href="NDPluginROIStat.html">NDPluginROIStat</a></li>
<li class="toctree-l3"><a class="reference internal" href="NDPluginScatter.html">NDPluginScatter</a></li>
<li class="toctree-l3"><a class="reference internal" href="NDPluginStats.html">NDPluginStats</a></li>
<li class="toctree-l3"><a class="reference internal" href="NDPluginStdArrays.html">NDPluginStdArrays</a></li>
<li class="toctree-l3"><a class="reference internal" href="NDPluginTimeSeries.html">NDPluginTimeSeries</a></li>
<li class="toctree-l3"><a class="reference internal" href="NDPluginTransform.html">NDPluginTransform</a></li>
<li class="toctree-l3"><a class="reference internal" href="NDPluginPos.html">NDPosPlugin</a></li>
<li class="toctree-l3"><a class="reference internal" href="ffmpegServer.html">ffmpegServer</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../additional_plugins.html">Additional plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="medm.html">MEDM screens</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ADViewers/ad_viewers.html">areaDetector Viewers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../acknowledgements.html">Acknowledgements and licenses</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../install_guide.html">Install Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release.html">Top-level Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ADCore_release.html">ADCore Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ADSupport_release.html">ADSupport Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doxygen.html">Source Code Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../detectors.html">Supported Detectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../legacy_versions.html">Legacy Versions</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">areaDetector</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../user_guide.html">areaDetector Users Guide</a></li>
          <li class="breadcrumb-item"><a href="plugins.html">areaDetector Plugins</a></li>
      <li class="breadcrumb-item active">NDPluginColorConvert</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/ADCore/NDPluginColorConvert.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="ndplugincolorconvert">
<h1><a class="toc-backref" href="#id1" role="doc-backlink">NDPluginColorConvert</a><a class="headerlink" href="#ndplugincolorconvert" title="Link to this heading"></a></h1>
<dl class="field-list simple">
<dt class="field-odd">author<span class="colon">:</span></dt>
<dd class="field-odd"><p>Mark Rivers, University of Chicago</p>
</dd>
</dl>
<nav class="contents" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#ndplugincolorconvert" id="id1">NDPluginColorConvert</a></p>
<ul>
<li><p><a class="reference internal" href="#overview" id="id2">Overview</a></p></li>
<li><p><a class="reference internal" href="#configuration" id="id3">Configuration</a></p></li>
<li><p><a class="reference internal" href="#screen-shots" id="id4">Screen shots</a></p></li>
<li><p><a class="reference internal" href="#performance" id="id5">Performance</a></p></li>
<li><p><a class="reference internal" href="#restrictions" id="id6">Restrictions</a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="overview">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Overview</a><a class="headerlink" href="#overview" title="Link to this heading"></a></h2>
<p>NDPluginColorConvert is a tool for converting the color mode of NDArray
data. It receives an input NDArray with one color mode and outputs
another NDArray with a (potentially) different color mode. All other
attributes of the array are preserved.</p>
<p>NDPluginColorConvert inherits from NDPluginDriver. The
<a class="reference external" href="../areaDetectorDoxygenHTML/class_n_d_plugin_color_convert.html">NDPluginColorConvert class
documentation</a>
describes this class in detail.</p>
<p>NDPluginColorConvert defines the following parameters. It also
implements all of the standard plugin parameters from
<a class="reference internal" href="NDPluginDriver.html"><span class="doc">NDPluginDriver</span></a>. The EPICS database
NDColorConvert.template provides access to these parameters, listed in
the following table.</p>
<table class="table-bordered table-striped table-hover docutils align-default">
<colgroup>
<col style="width: 5.0%" />
<col style="width: 5.0%" />
<col style="width: 5.0%" />
<col style="width: 70.0%" />
<col style="width: 5.0%" />
<col style="width: 5.0%" />
<col style="width: 5.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head" colspan="6"><p><strong>Parameter Definitions in NDPluginColorConvert.h and EPICS Record Definitions in
NDColorConvert.template</strong></p></th>
</tr>
<tr class="row-even"><th class="head"><p>Parameter index variable</p></th>
<th class="head"><p>asyn interface</p></th>
<th class="head"><p>Access</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>drvInfo string</p></th>
<th class="head"><p>EPICS record name</p></th>
<th class="head"><p>EPICS record type</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>NDPluginColorConvertColorModeOut</p></td>
<td><p>asynInt32</p></td>
<td><p>r/w</p></td>
<td><p>The output color mode (NDColorMode_t).</p></td>
<td><p>COLOR_MODE_OUT</p></td>
<td><p>$(P)$(R)ColorModeOut, $(P)$(R)ColorModeOut_RBV</p></td>
<td><p>mbbo, mbbi</p></td>
</tr>
<tr class="row-even"><td><p>NDPluginColorConvertFalseColor</p></td>
<td><p>asynInt32</p></td>
<td><p>r/w</p></td>
<td><p>The false color map index. There are currently 2 false color maps defined, Rainbow
and Iron. Additional color maps can easily be added in the future.</p></td>
<td><p>FALSE_COLOR</p></td>
<td><p>$(P)$(R)FalseColor, $(P)$(R)FalseColor_RBV</p></td>
<td><p>mbbo, mbbi</p></td>
</tr>
</tbody>
</table>
<p>When converting from 8-bit mono to RGB1, RGB2 or RGB3 a false-color map
will be applied if FalseColor is not zero.</p>
<p>The Bayer color conversion supports the 4 Bayer formats (NDBayerRGGB,
NDBayerGBRG, NDBayerGRBG, NDBayerBGGR) defined in <code class="docutils literal notranslate"><span class="pre">NDArray.h</span></code>. If the
input color mode and output color mode are not one of these supported
conversion combinations then the output array is simply a copy of the
input array and no conversion is performed.</p>
</section>
<section id="configuration">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Configuration</a><a class="headerlink" href="#configuration" title="Link to this heading"></a></h2>
<p>The NDPluginColorConvert plugin is created with the following command,
either from C/C++ or from the EPICS IOC shell.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">NDColorConvertConfigure</span><span class="p">(</span><span class="n">const</span> <span class="n">char</span> <span class="o">*</span><span class="n">portName</span><span class="p">,</span> <span class="nb">int</span> <span class="n">queueSize</span><span class="p">,</span> <span class="nb">int</span> <span class="n">blockingCallbacks</span><span class="p">,</span>
                            <span class="n">const</span> <span class="n">char</span> <span class="o">*</span><span class="n">NDArrayPort</span><span class="p">,</span> <span class="nb">int</span> <span class="n">NDArrayAddr</span><span class="p">,</span>
                            <span class="nb">int</span> <span class="n">maxBuffers</span><span class="p">,</span> <span class="n">size_t</span> <span class="n">maxMemory</span><span class="p">,</span>
                            <span class="nb">int</span> <span class="n">priority</span><span class="p">,</span> <span class="nb">int</span> <span class="n">stackSize</span><span class="p">)</span>
</pre></div>
</div>
<p>For details on the meaning of the parameters to this function refer to
the detailed documentation on the NDColorConvertConfigure function in
the <a class="reference external" href="../areaDetectorDoxygenHTML/_n_d_plugin_color_convert_8cpp.html">NDPluginColorConvert.cpp
documentation</a>
and in the documentation for the constructor for the
<a class="reference external" href="../areaDetectorDoxygenHTML/class_n_d_plugin_color_convert.html">NDPluginColorConvert
class</a>.</p>
</section>
<section id="screen-shots">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Screen shots</a><a class="headerlink" href="#screen-shots" title="Link to this heading"></a></h2>
<p>The following is the MEDM screen that provides access to the parameters
in <code class="docutils literal notranslate"><span class="pre">NDPluginDriver.h</span></code> and <code class="docutils literal notranslate"><span class="pre">NDPluginColorConvert.h</span></code> through records in
<code class="docutils literal notranslate"><span class="pre">NDPluginBase.template</span></code> and <code class="docutils literal notranslate"><span class="pre">NDColorConvert.template</span></code>.</p>
<img alt="../_images/NDColorConvert.png" class="align-center" src="../_images/NDColorConvert.png" />
</section>
<section id="performance">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Performance</a><a class="headerlink" href="#performance" title="Link to this heading"></a></h2>
<p>The following performance for Bayer conversion was measured on a RHEL6 workstation with a
3.6 GHz 4C/8T Intel W-2123 CPU and 16 GB of RAM.
The first two rows show the plugin not having to do anything, and the next four show
real conversions with two different image sizes and different output modes.</p>
<table class="table-bordered table-striped table-hover docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Input</p></th>
<th class="head"><p>Output</p></th>
<th class="head"><p>SizeX</p></th>
<th class="head"><p>Size Y</p></th>
<th class="head"><p>Average (ms)</p></th>
<th class="head"><p>S.D. (ms)</p></th>
<th class="head"><p>Samples</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>RGB</p></td>
<td><p>RGB</p></td>
<td><p>1292</p></td>
<td><p>964</p></td>
<td><p>1.436</p></td>
<td><p>0.344</p></td>
<td><p>103</p></td>
</tr>
<tr class="row-odd"><td><p>RGB</p></td>
<td><p>RGB</p></td>
<td><p>646</p></td>
<td><p>482</p></td>
<td><p>0.488</p></td>
<td><p>0.142</p></td>
<td><p>158</p></td>
</tr>
<tr class="row-even"><td><p>Bayer</p></td>
<td><p>RGB</p></td>
<td><p>1292</p></td>
<td><p>964</p></td>
<td><p>19.534</p></td>
<td><p>3.247</p></td>
<td><p>154</p></td>
</tr>
<tr class="row-odd"><td><p>Bayer</p></td>
<td><p>RGB</p></td>
<td><p>646</p></td>
<td><p>482</p></td>
<td><p>9.306</p></td>
<td><p>2.912</p></td>
<td><p>148</p></td>
</tr>
<tr class="row-even"><td><p>Bayer</p></td>
<td><p>Mono</p></td>
<td><p>1292</p></td>
<td><p>964</p></td>
<td><p>20.889</p></td>
<td><p>2.737</p></td>
<td><p>151</p></td>
</tr>
<tr class="row-odd"><td><p>Bayer</p></td>
<td><p>Mono</p></td>
<td><p>646</p></td>
<td><p>482</p></td>
<td><p>8.985</p></td>
<td><p>2.927</p></td>
<td><p>135</p></td>
</tr>
</tbody>
</table>
</section>
<section id="restrictions">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">Restrictions</a><a class="headerlink" href="#restrictions" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>The Bayer color conversion uses a simple linear interpolation and as seen in the table above can only
process about 60 MPixels per second.</p>
<ul>
<li><p>For Point Grey/FLIR cameras the ADPointGrey and ADSpinnaker drivers do Bayer color conversion
in the vendor library, which is significantly faster.</p></li>
<li><p>For Prosilica/AVT cameras the ADProsilica and ADVimba drivers also do Bayer color conversion
in the vendor library, which is significantly faster.</p></li>
</ul>
</li>
<li><p>YUV color conversion is not supported. This may be added in a future
release.</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="NDPluginCodec.html" class="btn btn-neutral float-left" title="NDPluginCodec" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="NDPluginFFT.html" class="btn btn-neutral float-right" title="NDPluginFFT" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Mark Rivers.
      <span class="lastupdated">Last updated on 2024-January-02.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>