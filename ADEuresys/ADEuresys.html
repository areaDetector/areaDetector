

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ADEuresys &mdash; areaDetector Support</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme_overrides.css?v=254ed751" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="ADFastCCD" href="../ADFastCCD/index.html" />
    <link rel="prev" title="ADEiger" href="../ADEiger/eiger.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            areaDetector
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../readme.html">Readme</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../user_guide.html">User Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../ADCore/overview.html">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ADCore/arch.html">Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ADCore/asynPortDriver.html">asynPortDriver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ADCore/NDArray.html">NDArray</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../detector_drivers.html">Detector Drivers</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../ADCore/guidelines.html">Guidelines and rules for drivers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ADCore/ADDriver.html">ADDriver</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ADAndor/andorDoc.html">ADAndor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ADAndor3/ADAndorDoc.html">ADAndor3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ADAravis/ADAravis.html">ADAravis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ADCSimDetector/ADCSimDetectorDoc.html">ADCSimDetector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ADDexela/ADDexela.html">ADDexela</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ADEiger/eiger.html">ADEiger</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">ADEuresys</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#adeuresys-driver">ADEuresys driver</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ioc-startup-script">IOC startup script</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cameras-tested">Cameras Tested</a></li>
<li class="toctree-l4"><a class="reference internal" href="#file-saving-benchmarks">File saving benchmarks</a></li>
<li class="toctree-l4"><a class="reference internal" href="#medm-screens">MEDM screens</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../ADFastCCD/index.html">ADFastCCD</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ADGenICam/ADGenICam.html">ADGenICam</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ADHamamatsuDCAM/ADHamamatsuDCAM.html">ADHamamatsuDCAM</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ADLambda/ADLambda.html">ADLambda</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ADLightField/ADLightField.html">ADLightField</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ADmarCCD/marCCDDoc.html">ADmarCCD</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ADmar345/mar345Doc.html">ADmar345</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ADPerkinElmer/PerkinElmerDoc.html">ADPerkinElmer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ADPICam/PICamDoc.html">ADPICam</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ADPilatus/pilatusDoc.html">ADPilatus</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ADPvCam/pvcamDoc.html">ADPvCam</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ADPylon/ADPylon.html">ADPylon</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ADRIXSCam/ADRIXSCam.html">ADRIXSCam</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ADSimDetector/simDetector.html">ADSimDetector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ADSpinnaker/ADSpinnaker.html">ADSpinnaker</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ADTimePix3/ADTimePix3.html">ADTimePix3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ADTLBC2/ADTLBC2.html">ADTLBC2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ADVimba/ADVimba.html">ADVimba</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ADURL/ADURL.html">ADURL</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ADUVC/ADUVC.html">ADUVC</a></li>
<li class="toctree-l3"><a class="reference internal" href="../NDDriverStdArrays/NDDriverStdArraysDoc.html">NDDriverStdArrays</a></li>
<li class="toctree-l3"><a class="reference internal" href="../pvaDriver/pvaDriver.html">pvaDriver</a></li>
<li class="toctree-l3"><a class="reference internal" href="../specsAnalyser/index.html">specsAnalyser</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../ADCore/plugins.html">areaDetector Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../additional_plugins.html">Additional plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ADCore/medm.html">MEDM screens</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ADViewers/ad_viewers.html">areaDetector Viewers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../acknowledgements.html">Acknowledgements and licenses</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../install_guide.html">Install Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release.html">Top-level Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ADCore_release.html">ADCore Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ADSupport_release.html">ADSupport Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doxygen.html">Source Code Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../detectors.html">Supported Detectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../legacy_versions.html">Legacy Versions</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">areaDetector</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../user_guide.html">areaDetector Users Guide</a></li>
          <li class="breadcrumb-item"><a href="../detector_drivers.html">Detector Drivers</a></li>
      <li class="breadcrumb-item active">ADEuresys</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/ADEuresys/ADEuresys.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="adeuresys">
<h1><a class="toc-backref" href="#id8" role="doc-backlink">ADEuresys</a><a class="headerlink" href="#adeuresys" title="Link to this heading"></a></h1>
<dl class="field-list simple">
<dt class="field-odd">author<span class="colon">:</span></dt>
<dd class="field-odd"><p>Mark Rivers, University of Chicago</p>
</dd>
</dl>
<nav class="contents" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#adeuresys" id="id8">ADEuresys</a></p>
<ul>
<li><p><a class="reference internal" href="#overview" id="id9">Overview</a></p></li>
<li><p><a class="reference internal" href="#adeuresys-driver" id="id10">ADEuresys driver</a></p></li>
<li><p><a class="reference internal" href="#ioc-startup-script" id="id11">IOC startup script</a></p></li>
<li><p><a class="reference internal" href="#cameras-tested" id="id12">Cameras Tested</a></p></li>
<li><p><a class="reference internal" href="#file-saving-benchmarks" id="id13">File saving benchmarks</a></p></li>
<li><p><a class="reference internal" href="#medm-screens" id="id14">MEDM screens</a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="overview">
<h2><a class="toc-backref" href="#id9" role="doc-backlink">Overview</a><a class="headerlink" href="#overview" title="Link to this heading"></a></h2>
<p>This is an <a class="reference internal" href="../index.html"><span class="doc">areaDetector</span></a> driver for <a class="reference external" href="https://www.coaxpress.com">CoaXPress</a> cameras using the <a class="reference external" href="https://www.euresys.com/en/Homepage">Euresys</a> CoaxLink frame grabbers and <a class="reference external" href="https://www.euresys.com/en/Products/Machine-Vision-Software/eGrabber">EGrabber</a> SDK.</p>
<p>CoaXPress is a high-speed camera interface using one or more parallel coaxial cables between the camera and a frame grabber
in a computer.  The following table shows the speeds and cable length limits for different standard CoaXPress bit rates.</p>
<table class="table-bordered table-striped table-hover docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Bit rate</p></th>
<th class="head"><p>Maximum cable length with Belden 1694A RG-6 cables</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>CXP-1</p></td>
<td><p>1.25 Gbit/s</p></td>
<td><p>130 m</p></td>
</tr>
<tr class="row-odd"><td><p>CXP-2</p></td>
<td><p>2.5 Gbit/s</p></td>
<td><p>110 m</p></td>
</tr>
<tr class="row-even"><td><p>CXP-3</p></td>
<td><p>3.125 Gbit/s</p></td>
<td><p>100 m</p></td>
</tr>
<tr class="row-odd"><td><p>CXP-5</p></td>
<td><p>5.0 Gbit/s</p></td>
<td><p>60 m</p></td>
</tr>
<tr class="row-even"><td><p>CXP-6</p></td>
<td><p>6.25 Gbit/s</p></td>
<td><p>40 m</p></td>
</tr>
<tr class="row-odd"><td><p>CXP-10</p></td>
<td><p>10.0 Gbit/s</p></td>
<td><p>40 m</p></td>
</tr>
<tr class="row-even"><td><p>CXP-12</p></td>
<td><p>12.5 Gbit/s</p></td>
<td><p>30 m</p></td>
</tr>
</tbody>
</table>
<p>A CXP-12 X4 camera has 4 parallel CXP-12 links, and thus runs at a total rate of 50 Gbit/s.</p>
<p>CoaXPress cameras use the <a class="reference external" href="https://www.emva.org/standards-technology/genicam">GenICam</a> standard. <a class="reference external" href="https://www.emva.org/standards-technology/genicam">GenICam</a> is a Generic Interface for Cameras from the
European Machine Vision Association (EMVA).</p>
<p>ADEuresys is derived from the base class <a class="reference external" href="https://github.com/areaDetector/ADGenICam">ADGenICam</a>, which handles many of the details of
mapping <a class="reference external" href="https://www.emva.org/standards-technology/genicam">GenICam</a> features to EPICS records.
<a class="reference external" href="../areaDetectorDoxygenHTML/class_a_d_euresys.html">ADEuresys class</a> describes this class in detail.</p>
<p><a class="reference external" href="https://github.com/areaDetector/ADEuresys">ADEuresys</a> uses the Euresys <a class="reference external" href="https://www.euresys.com/en/Products/Machine-Vision-Software/eGrabber">EGrabber</a> SDK. It runs on most versions of Windows and Linux.
The driver is identical on Windows and Linux, there is no OS-specific code in the driver.</p>
<p><a class="reference external" href="https://github.com/areaDetector/ADEuresys">ADEuresys</a> currently only supports CoaXPress frame grabbers.
<a class="reference external" href="https://www.euresys.com/en/Products/Machine-Vision-Software/eGrabber">EGrabber</a> also supports their CameraLink frame grabbers and GigE cameras.
Support for these could be added in the future, either as part of ADEuresys, or as a separate areaDetector driver.</p>
<p>The <a class="reference external" href="https://www.euresys.com/en/Products/Machine-Vision-Software/eGrabber">EGrabber</a> SDK must be downloaded and installed prior to building the driver.
It can be found in the Download area on the <a class="reference external" href="https://www.euresys.com/en/Homepage">Euresys</a> website.
On Windows this is a standard installation procedure.
On Linux there is an install.sh script which builds the kernel driver for the frame grabber
and installs the include and binary files in /opt/euresys.</p>
<p>The ADEuresys/configure/CONFIG_SITE or ADEuresys/configure/CONFIG_SITE.$(EPICS_HOST_ARCH).Common files must be edited
to point to the location of the include files on the local system.</p>
<p>Prior to using ADEuresys with a specific camera model, the XML file must be read from the camera using the Euresys gentl utility.
Run the command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gentl</span> <span class="n">xml</span>
</pre></div>
</div>
<p>This will extract the XML files for both the camera and the GenTL components System, Interface, Device, and DataStream
and save as files in the current default directory.</p>
<p>The EPICS database file and OPI screens must then be generated from the camera XML file
by running the Python programs as described in the
<a class="reference internal" href="../ADGenICam/ADGenICam.html#adgenicam-python-scripts"><span class="std std-ref">ADGenICam documentation</span></a>.</p>
</section>
<section id="adeuresys-driver">
<h2><a class="toc-backref" href="#id10" role="doc-backlink">ADEuresys driver</a><a class="headerlink" href="#adeuresys-driver" title="Link to this heading"></a></h2>
<p>ADEuresys inherits from <a class="reference internal" href="../ADGenICam/ADGenICam.html"><span class="doc">ADGenICam</span></a>.  It adds the following parameters and EPICS records that are
specific to ADEuresys.</p>
<table class="table-bordered table-striped table-hover docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>EPICS record names</p></th>
<th class="head"><p>Record types</p></th>
<th class="head"><p>drvInfo string</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>TimeStampMode, TimeStampMode_RBV</p></td>
<td><p>bo, bi</p></td>
<td><p>ES_TIME_STAMP_MODE</p></td>
<td><p>Controls whether the TimeStamp attribute comes from the camera internal time stamp or from the EPICS time.
Choices are Camera (0), and EPICS (1).</p></td>
</tr>
<tr class="row-odd"><td><p>UniqueIdMode, UniqueIdMode_RBV</p></td>
<td><p>bo, bi</p></td>
<td><p>ES_UNIQUE_ID_MODE</p></td>
<td><p>Controls whether the UniqueId attribute comes from the camera internal value or from the driver.
Choices are Camera (0), and Driver (1).</p></td>
</tr>
<tr class="row-even"><td><p>UnpackingMode, UnpackingMode_RBV</p></td>
<td><p>mbbo, mbbi</p></td>
<td><p>ES_UNPACKING_MODE</p></td>
<td><p>Controls conversion of Mono10 and Mono12 formats to Mono16.
Mono10 and Mono12 data are sent across the CXP cables in packed format.
These formats can be unpacked by the DMA engine to Mono16 with the following choices:</p>
<ul class="simple">
<li><p>LSB The frame grabber adds leading 0 bits, so Mono10 will range from 0 to 1023 and Mono12 from 0 to 4095.</p></li>
<li><p>MSB The frame grabber adds trailing 0 bit. Mono10 values can thus be 0, 64, 128, … 65472,
and Mono12 values can be 0, 16, 32, … 65520.</p></li>
<li><p>Off No padding bits are added and the pixel data are not aligned on byte boundaries.</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>ConvertPixelFormat, ConvertPixelFormat_RBV</p></td>
<td><p>mbbo, mbbi</p></td>
<td><p>ES_CONVERT_PIXEL_FORMAT</p></td>
<td><p>Controls conversion of the pixel format read from the camera to a different format.  For example this can be used
to convert Bayer to RGB which allows the camera to send 8-bit data over the bus and then convert to 24-bit
RGB on the host computer, reducing the required bandwidth and increasing the frame rate.
NOTE: This is currently not implemented in the driver because I don’t have a color camera
to use for testing.</p></td>
</tr>
<tr class="row-even"><td><p>ESBufferSize</p></td>
<td><p>longin</p></td>
<td><p>ES_BUFFER_SIZE</p></td>
<td><p>The number of EGrabber buffers allocated when the driver is created.</p></td>
</tr>
<tr class="row-odd"><td><p>OutputQueue</p></td>
<td><p>longin</p></td>
<td><p>ES_OUTPUT_QUEUE</p></td>
<td><p>The number of buffers in the EGrabber output queue waiting for the ADEuresys driver to process.</p></td>
</tr>
<tr class="row-even"><td><p>RejectedFrames</p></td>
<td><p>longin</p></td>
<td><p>ES_REJECTED_FRAMES</p></td>
<td><p>The number of frames that the EGrabber dropped when the output queue overflowed because the
ADEuresys driver could not keep up.</p></td>
</tr>
<tr class="row-odd"><td><p>CRCErrors</p></td>
<td><p>longin</p></td>
<td><p>ES_CRC_ERROR_COUNT</p></td>
<td><p>The number CRC errors on the CoVisionaXPress links to the camera.</p></td>
</tr>
<tr class="row-even"><td><p>ResetErrorCounts</p></td>
<td><p>bo</p></td>
<td><p>ES_RESET_ERROR_COUNTS</p></td>
<td><p>Resets RejectedFrames and CRCErVisionrors to 0.</p></td>
</tr>
<tr class="row-odd"><td><p>ProcessTotalTime</p></td>
<td><p>ai</p></td>
<td><p>ES_PROCESS_TOTAL_TIME</p></td>
<td><p>The total execution time of the frame callback function in ms.</p></td>
</tr>
<tr class="row-even"><td><p>ProcessCopyTime</p></td>
<td><p>ai</p></td>
<td><p>ES_PROCESS_COPY_TIME</p></td>
<td><p>The time in ms required to copy the data from the EGrabber buffer to the NDArray
in the frame callback function.  This is included in ProcessTotalTime.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="ioc-startup-script">
<h2><a class="toc-backref" href="#id11" role="doc-backlink">IOC startup script</a><a class="headerlink" href="#ioc-startup-script" title="Link to this heading"></a></h2>
<p>The command to configure an ADEuresys camera in the startup script is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ADEuresysConfig</span><span class="p">(</span><span class="n">const</span> <span class="n">char</span> <span class="o">*</span><span class="n">portName</span><span class="p">,</span> <span class="n">const</span> <span class="n">char</span> <span class="o">*</span><span class="n">cameraId</span><span class="p">,</span> <span class="nb">int</span> <span class="n">numEGBuffers</span><span class="p">,</span>
                <span class="n">size_t</span> <span class="n">maxMemory</span><span class="p">,</span> <span class="nb">int</span> <span class="n">priority</span><span class="p">,</span> <span class="nb">int</span> <span class="n">stackSize</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">portName</span></code> is the name for the ADEuresys port driver</p>
<p><code class="docutils literal notranslate"><span class="pre">cameraId</span></code> is used to identify which camera to control.
In most cases there will be a single frame grabber card in the system, connected to a single camera.
This parameter is currently not implemented, but could be in the future if it is desired to use
multiple cameras from one computer.</p>
<p><code class="docutils literal notranslate"><span class="pre">numEGBuffers</span></code> is the number of buffers to allocate in EGrabber. If set to 0 or omitted the default of 100 will be used.</p>
<p><code class="docutils literal notranslate"><span class="pre">maxMemory</span></code> is the maximum amount of memory the NDArrayPool is allowed to allocate.  0 means unlimited.</p>
<p><code class="docutils literal notranslate"><span class="pre">priority</span></code> is the priority of the port thread.  0 means medium priority.</p>
<p><code class="docutils literal notranslate"><span class="pre">stackSize</span></code> is the stack size.  0 means medium size.</p>
</section>
<section id="cameras-tested">
<h2><a class="toc-backref" href="#id12" role="doc-backlink">Cameras Tested</a><a class="headerlink" href="#cameras-tested" title="Link to this heading"></a></h2>
<p><a class="reference external" href="https://github.com/areaDetector/ADEuresys">ADEuresys</a> has been tested with 3 very different cameras, shown in the following table.</p>
<table class="table-bordered table-striped table-hover docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Model</p></th>
<th class="head"><p>Mikrotron EoSens 2.0MCX12</p></th>
<th class="head"><p>Adimec Q-12A</p></th>
<th class="head"><p>ViewWorks VNP604</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Pixel dimensions</p></td>
<td><p>1920 x 1080</p></td>
<td><p>4096 x 3072</p></td>
<td><p>14192 x 10640</p></td>
</tr>
<tr class="row-odd"><td><p>MegaPixels</p></td>
<td><p>2.1</p></td>
<td><p>12.6</p></td>
<td><p>151.0</p></td>
</tr>
<tr class="row-even"><td><p>CXP version</p></td>
<td><p>CXP-12 X4</p></td>
<td><p>CXP-6 X4</p></td>
<td><p>CXP-6 X4</p></td>
</tr>
<tr class="row-odd"><td><p>Frames/s, Mono8</p></td>
<td><p>2247</p></td>
<td><p>187</p></td>
<td><p>6.5</p></td>
</tr>
<tr class="row-even"><td><p>GBytes/s. Mono8</p></td>
<td><p>4.66</p></td>
<td><p>2.35</p></td>
<td><p>1.0</p></td>
</tr>
<tr class="row-odd"><td><p>Frames/s, Mono10</p></td>
<td><p>1798</p></td>
<td><p>152</p></td>
<td><p>6.2</p></td>
</tr>
<tr class="row-even"><td><p>GBytes/s. Mono10</p></td>
<td><p>7.46</p></td>
<td><p>3.83</p></td>
<td><p>2.0</p></td>
</tr>
<tr class="row-odd"><td><p>Frames/s, Mono12</p></td>
<td><p>N.A</p></td>
<td><p>N.A</p></td>
<td><p>6.2</p></td>
</tr>
<tr class="row-even"><td><p>GBytes/s. Mono12</p></td>
<td><p>N.A</p></td>
<td><p>N.A</p></td>
<td><p>2.0</p></td>
</tr>
</tbody>
</table>
<p>The ADEuresys driver can collect the images from these cameras at the full specified frame rates
in the table above, with one exception.
The Mikrotron camera in 10-bit mode has a maximum from rate of 1798 frames/s.
However, ADEuresys only receives 1668 frames/s on Linux and 1703 frames/s on Windows.
This is due to limitations on the PCIe transfer speeds of the frame grabber when expanding the
10-bit frames to 16-bit.</p>
<figure class="align-center" id="id2">
<a class="reference internal image-reference" href="../_images/Mikrotron_photo.jpg"><img alt="../_images/Mikrotron_photo.jpg" src="../_images/Mikrotron_photo.jpg" style="width: 600px;" /></a>
<figcaption>
<p><span class="caption-text">Mikrotron EoSens 2.0MCX12</span><a class="headerlink" href="#id2" title="Link to this image"></a></p>
</figcaption>
</figure>
<figure class="align-center" id="id3">
<a class="reference internal image-reference" href="../_images/Adimec_photo.jpg"><img alt="../_images/Adimec_photo.jpg" src="../_images/Adimec_photo.jpg" style="width: 600px;" /></a>
<figcaption>
<p><span class="caption-text">Adimec Q-12A</span><a class="headerlink" href="#id3" title="Link to this image"></a></p>
</figcaption>
</figure>
<figure class="align-center" id="id4">
<a class="reference internal image-reference" href="../_images/ViewWorks_photo.jpg"><img alt="../_images/ViewWorks_photo.jpg" src="../_images/ViewWorks_photo.jpg" style="width: 600px;" /></a>
<figcaption>
<p><span class="caption-text">ViewWorks VNP604</span><a class="headerlink" href="#id4" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="file-saving-benchmarks">
<h2><a class="toc-backref" href="#id13" role="doc-backlink">File saving benchmarks</a><a class="headerlink" href="#file-saving-benchmarks" title="Link to this heading"></a></h2>
<p>The following table shows the results of writing data to disk with the NDFileHDF5 plugin.
These tests were done on a computer with the following specifications:</p>
<blockquote>
<div><ul class="simple">
<li><p>Model: Dell Precision 5860</p></li>
<li><p>Processor: Intel Xeon w5-2445, 3100 MHz</p></li>
<li><p>RAM: 256GB</p></li>
<li><p>Disk: 1 TB MVMe in M.2 slot on motherboard</p></li>
<li><p>OS: Windows 10 and CentOS 9 Stream, dual boot</p></li>
<li><p>CoaXPress card: Euresys CoaxLink CXP-12</p></li>
</ul>
</div></blockquote>
<p>The tests were done in both Mono8, and Mono10 or Mono12 modes.
In Mono8 mode the NDArrays are UInt8.  In Mono10 or Mono12 modes the NDArrays are UInt16.
The same tests were done on Windows 10 and CentOS 9 Stream.</p>
<p>In each mode tests were done with the HDF5 plugin in both Stream mode and Capture mode.</p>
<p>In Stream mode the HDF5 files are written to disk as they are being collected.
The camera frame rate was adjusted to the value that led to no dropped frames
when saving the specified number of frames, while using a 2000 frame queue.</p>
<p>In Capture mode the specified number of frames were saved into the capture buffer
at the full frame rate for that mode.
The HDF5 file was then written to disk after the capture was complete,
and the total time to write the file was measured.
This allows calculating the file saving frame rate and data rate.</p>
<table class="table-bordered table-striped table-hover docutils align-default" id="id5">
<caption><span class="caption-text"><strong>Mikroton camera (Mono8=50,000 frames, Mono10=30,000 frames)</strong></span><a class="headerlink" href="#id5" title="Link to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Format</p></th>
<th class="head"><p>OS</p></th>
<th class="head"><p>Camera frames/s</p></th>
<th class="head"><p>File mode</p></th>
<th class="head"><p>File frames/s</p></th>
<th class="head"><p>GB/s</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Mono8</p></td>
<td><p>Linux</p></td>
<td><p>2247</p></td>
<td><p>Stream</p></td>
<td><p>1400</p></td>
<td><p>2.90</p></td>
</tr>
<tr class="row-odd"><td><p>Mono8</p></td>
<td><p>Windows</p></td>
<td><p>2247</p></td>
<td><p>Stream</p></td>
<td><p>1700</p></td>
<td><p>3.53</p></td>
</tr>
<tr class="row-even"><td><p>Mono8</p></td>
<td><p>Linux</p></td>
<td><p>2247</p></td>
<td><p>Capture</p></td>
<td><p>1429</p></td>
<td><p>2.96</p></td>
</tr>
<tr class="row-odd"><td><p>Mono8</p></td>
<td><p>Windows</p></td>
<td><p>2247</p></td>
<td><p>Capture</p></td>
<td><p>1786</p></td>
<td><p>3.70</p></td>
</tr>
<tr class="row-even"><td><p>Mono10</p></td>
<td><p>Linux</p></td>
<td><p>1668</p></td>
<td><p>Stream</p></td>
<td><p>650</p></td>
<td><p>2.70</p></td>
</tr>
<tr class="row-odd"><td><p>Mono10</p></td>
<td><p>Windows</p></td>
<td><p>1703</p></td>
<td><p>Stream</p></td>
<td><p>800</p></td>
<td><p>3.32</p></td>
</tr>
<tr class="row-even"><td><p>Mono10</p></td>
<td><p>Linux</p></td>
<td><p>1668</p></td>
<td><p>Capture</p></td>
<td><p>666</p></td>
<td><p>2.76</p></td>
</tr>
<tr class="row-odd"><td><p>Mono10</p></td>
<td><p>Windows</p></td>
<td><p>1703</p></td>
<td><p>Capture</p></td>
<td><p>909</p></td>
<td><p>3.77</p></td>
</tr>
</tbody>
</table>
<table class="table-bordered table-striped table-hover docutils align-default" id="id6">
<caption><span class="caption-text"><strong>Adimec camera (Mono8=10,000 frames, Mono10=10,000 frames)</strong></span><a class="headerlink" href="#id6" title="Link to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Format</p></th>
<th class="head"><p>OS</p></th>
<th class="head"><p>Camera frames/s</p></th>
<th class="head"><p>File mode</p></th>
<th class="head"><p>File frames/s</p></th>
<th class="head"><p>GB/s</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Mono8</p></td>
<td><p>Linux</p></td>
<td><p>187</p></td>
<td><p>Stream</p></td>
<td><p>187</p></td>
<td><p>2.35</p></td>
</tr>
<tr class="row-odd"><td><p>Mono8</p></td>
<td><p>Windows</p></td>
<td><p>187</p></td>
<td><p>Stream</p></td>
<td><p>187</p></td>
<td><p>2.35</p></td>
</tr>
<tr class="row-even"><td><p>Mono8</p></td>
<td><p>Linux</p></td>
<td><p>187</p></td>
<td><p>Capture</p></td>
<td><p>286</p></td>
<td><p>3.60</p></td>
</tr>
<tr class="row-odd"><td><p>Mono8</p></td>
<td><p>Windows</p></td>
<td><p>187</p></td>
<td><p>Capture</p></td>
<td><p>312</p></td>
<td><p>3.93</p></td>
</tr>
<tr class="row-even"><td><p>Mono10</p></td>
<td><p>Linux</p></td>
<td><p>152</p></td>
<td><p>Stream</p></td>
<td><p>90</p></td>
<td><p>2.27</p></td>
</tr>
<tr class="row-odd"><td><p>Mono10</p></td>
<td><p>Windows</p></td>
<td><p>152</p></td>
<td><p>Stream</p></td>
<td><p>90</p></td>
<td><p>2.27</p></td>
</tr>
<tr class="row-even"><td><p>Mono10</p></td>
<td><p>Linux</p></td>
<td><p>152</p></td>
<td><p>Capture</p></td>
<td><p>92</p></td>
<td><p>2.32</p></td>
</tr>
<tr class="row-odd"><td><p>Mono10</p></td>
<td><p>Windows</p></td>
<td><p>152</p></td>
<td><p>Capture</p></td>
<td><p>84</p></td>
<td><p>2.11</p></td>
</tr>
</tbody>
</table>
<table class="table-bordered table-striped table-hover docutils align-default" id="id7">
<caption><span class="caption-text"><strong>ViewWorks camera (Mono8=1,000 frames, Mono12=500 frames)</strong></span><a class="headerlink" href="#id7" title="Link to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Format</p></th>
<th class="head"><p>OS</p></th>
<th class="head"><p>Camera frames/s</p></th>
<th class="head"><p>File mode</p></th>
<th class="head"><p>File frames/s</p></th>
<th class="head"><p>GB/s</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Mono8</p></td>
<td><p>Linux</p></td>
<td><p>6.2</p></td>
<td><p>Stream</p></td>
<td><p>6.2</p></td>
<td><p>0.94</p></td>
</tr>
<tr class="row-odd"><td><p>Mono8</p></td>
<td><p>Windows</p></td>
<td><p>6.2</p></td>
<td><p>Stream</p></td>
<td><p>6.2</p></td>
<td><p>0.94</p></td>
</tr>
<tr class="row-even"><td><p>Mono8</p></td>
<td><p>Linux</p></td>
<td><p>6.2</p></td>
<td><p>Capture</p></td>
<td><p>16.7</p></td>
<td><p>2.52</p></td>
</tr>
<tr class="row-odd"><td><p>Mono8</p></td>
<td><p>Windows</p></td>
<td><p>6.2</p></td>
<td><p>Capture</p></td>
<td><p>9.7</p></td>
<td><p>1.46</p></td>
</tr>
<tr class="row-even"><td><p>Mono12</p></td>
<td><p>Linux</p></td>
<td><p>6.2</p></td>
<td><p>Stream</p></td>
<td><p>6.2</p></td>
<td><p>1.87</p></td>
</tr>
<tr class="row-odd"><td><p>Mono12</p></td>
<td><p>Windows</p></td>
<td><p>6.2</p></td>
<td><p>Stream</p></td>
<td><p>5.0</p></td>
<td><p>1.51</p></td>
</tr>
<tr class="row-even"><td><p>Mono12</p></td>
<td><p>Linux</p></td>
<td><p>6.2</p></td>
<td><p>Capture</p></td>
<td><p>8.8</p></td>
<td><p>2.66</p></td>
</tr>
<tr class="row-odd"><td><p>Mono12</p></td>
<td><p>Windows</p></td>
<td><p>6.2</p></td>
<td><p>Capture</p></td>
<td><p>3.7</p></td>
<td><p>1.11</p></td>
</tr>
</tbody>
</table>
<p>I tried three schemes to see if I could increase the file saving rate to keep up with the Mikrotron camera.</p>
<p>The first was to load 2 NDFileHDF5 plugins, and use NDPluginScatter to send every other frame to each
plugin.  If file rate was limited by CPU load on the HDF5 plugin this should improve performance.
I found that this did not help at all, each plugin ran at 50% of the frame rate of a single HDF5 plugin.
I believe this indicates that the rate is limited by a global mutex in the HDF5 library, since neither
plugin was CPU bound, and I don’t think they were limited by the NVMe disk write rate.</p>
<p>The second scheme was to create 2 pvaDriver IOCs on the same computer.  Each of these runs an HDF5
file writer.  The ADEuresys IOC loads 2 NDPluginPva plugins, each connected to one of the
pvaDriver IOCs.  NDPluginScatter on the ADEuresys IOC sends every other frame to each NDPluginPva.
This did not work because the PVA links could not keep up.  I also found that the PVA links dropped
frames even at 100 frames/s.  This needs to be investigated, because PVA should not be dropping frames
under low loads.</p>
<p>The third scheme was to write a new file plugin called NDFileJRaw.  This plugin uses a simple raw format,
using the low-level OS-specific calls to write the NDArrays.  The “J” in JRaw indicates a future plan
to put JSON metadata in the file to indicate the data format and size, and possibly to store NDAttributes.
I found that writing files with JRaw, both in Stream mode and Capture mode, did not result in a
statistically significant improvement over HDF5.  In some cases it was faster, but in some it was
slower.  The results are in the benchmarks.txt file in the docs/ADEuresys directory.  For brevity
I have not included them in the table above.</p>
</section>
<section id="medm-screens">
<h2><a class="toc-backref" href="#id14" role="doc-backlink">MEDM screens</a><a class="headerlink" href="#medm-screens" title="Link to this heading"></a></h2>
<p>The following is the MEDM screen ADEuresys.adl when controlling a Miktron EoSens 2.0MCX12 camera.
ADEuresys.adl is very similar to ADGenICam.adl, with a few additional widgets for the PVs that are
specific to ADEuresys.</p>
<p>Note that each frame is 2.1 MB, and it is collecting 2,247 frames/s, which is 4.66 GB/s.</p>
<figure class="align-center">
<img alt="../_images/ADEuresys_Mikrotron.png" src="../_images/ADEuresys_Mikrotron.png" />
</figure>
<p>The following are the camera-specfic features MEDM screens for the Mikrotron camera.
These screens were autogenerated by the Python script in <a class="reference internal" href="../ADGenICam/ADGenICam.html"><span class="doc">ADGenICam</span></a>, and are specific to this camera model.
They are loaded from the “Camera-specific features” related display widget in the above screen.</p>
<figure class="align-center">
<img alt="../_images/ADEuresys_Mikrotron_Features1.png" src="../_images/ADEuresys_Mikrotron_Features1.png" />
</figure>
<figure class="align-center">
<img alt="../_images/ADEuresys_Mikrotron_Features2.png" src="../_images/ADEuresys_Mikrotron_Features2.png" />
</figure>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../ADEiger/eiger.html" class="btn btn-neutral float-left" title="ADEiger" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../ADFastCCD/index.html" class="btn btn-neutral float-right" title="ADFastCCD" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Mark Rivers.
      <span class="lastupdated">Last updated on 2025-September-29.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>